{"ast":null,"code":"import { ref, watch, onMounted, onBeforeUnmount, nextTick, getCurrentInstance } from 'vue';\nimport { clearSelection } from '../../utils/private/selection.js';\nimport { addEvt, cleanEvt, prevent } from '../../utils/event.js';\nimport { isKeyCode } from '../../utils/private/key-composition.js';\nexport const useAnchorProps = {\n  target: {\n    default: true\n  },\n  noParentEvent: Boolean,\n  contextMenu: Boolean\n};\nexport default function ({\n  showing,\n  avoidEmit,\n  // required for QPopupProxy (true)\n  configureAnchorEl // optional\n}) {\n  const {\n    props,\n    proxy,\n    emit\n  } = getCurrentInstance();\n  const anchorEl = ref(null);\n  let touchTimer = null;\n  function canShow(evt) {\n    // abort with no parent configured or on multi-touch\n    return anchorEl.value === null ? false : evt === void 0 || evt.touches === void 0 || evt.touches.length <= 1;\n  }\n  const anchorEvents = {};\n  if (configureAnchorEl === void 0) {\n    // default configureAnchorEl is designed for\n    // QMenu & QPopupProxy (which is why it's handled here)\n\n    Object.assign(anchorEvents, {\n      hide(evt) {\n        proxy.hide(evt);\n      },\n      toggle(evt) {\n        proxy.toggle(evt);\n        evt.qAnchorHandled = true;\n      },\n      toggleKey(evt) {\n        isKeyCode(evt, 13) === true && anchorEvents.toggle(evt);\n      },\n      contextClick(evt) {\n        proxy.hide(evt);\n        prevent(evt);\n        nextTick(() => {\n          proxy.show(evt);\n          evt.qAnchorHandled = true;\n        });\n      },\n      prevent,\n      mobileTouch(evt) {\n        anchorEvents.mobileCleanup(evt);\n        if (canShow(evt) !== true) {\n          return;\n        }\n        proxy.hide(evt);\n        anchorEl.value.classList.add('non-selectable');\n        const target = evt.target;\n        addEvt(anchorEvents, 'anchor', [[target, 'touchmove', 'mobileCleanup', 'passive'], [target, 'touchend', 'mobileCleanup', 'passive'], [target, 'touchcancel', 'mobileCleanup', 'passive'], [anchorEl.value, 'contextmenu', 'prevent', 'notPassive']]);\n        touchTimer = setTimeout(() => {\n          touchTimer = null;\n          proxy.show(evt);\n          evt.qAnchorHandled = true;\n        }, 300);\n      },\n      mobileCleanup(evt) {\n        anchorEl.value.classList.remove('non-selectable');\n        if (touchTimer !== null) {\n          clearTimeout(touchTimer);\n          touchTimer = null;\n        }\n        if (showing.value === true && evt !== void 0) {\n          clearSelection();\n        }\n      }\n    });\n    configureAnchorEl = function (context = props.contextMenu) {\n      if (props.noParentEvent === true || anchorEl.value === null) {\n        return;\n      }\n      let evts;\n      if (context === true) {\n        if (proxy.$q.platform.is.mobile === true) {\n          evts = [[anchorEl.value, 'touchstart', 'mobileTouch', 'passive']];\n        } else {\n          evts = [[anchorEl.value, 'mousedown', 'hide', 'passive'], [anchorEl.value, 'contextmenu', 'contextClick', 'notPassive']];\n        }\n      } else {\n        evts = [[anchorEl.value, 'click', 'toggle', 'passive'], [anchorEl.value, 'keyup', 'toggleKey', 'passive']];\n      }\n      addEvt(anchorEvents, 'anchor', evts);\n    };\n  }\n  function unconfigureAnchorEl() {\n    cleanEvt(anchorEvents, 'anchor');\n  }\n  function setAnchorEl(el) {\n    anchorEl.value = el;\n    while (anchorEl.value.classList.contains('q-anchor--skip')) {\n      anchorEl.value = anchorEl.value.parentNode;\n    }\n    configureAnchorEl();\n  }\n  function pickAnchorEl() {\n    if (props.target === false || props.target === '' || proxy.$el.parentNode === null) {\n      anchorEl.value = null;\n    } else if (props.target === true) {\n      setAnchorEl(proxy.$el.parentNode);\n    } else {\n      let el = props.target;\n      if (typeof props.target === 'string') {\n        try {\n          el = document.querySelector(props.target);\n        } catch (err) {\n          el = void 0;\n        }\n      }\n      if (el !== void 0 && el !== null) {\n        anchorEl.value = el.$el || el;\n        configureAnchorEl();\n      } else {\n        anchorEl.value = null;\n        console.error(`Anchor: target \"${props.target}\" not found`);\n      }\n    }\n  }\n  watch(() => props.contextMenu, val => {\n    if (anchorEl.value !== null) {\n      unconfigureAnchorEl();\n      configureAnchorEl(val);\n    }\n  });\n  watch(() => props.target, () => {\n    if (anchorEl.value !== null) {\n      unconfigureAnchorEl();\n    }\n    pickAnchorEl();\n  });\n  watch(() => props.noParentEvent, val => {\n    if (anchorEl.value !== null) {\n      if (val === true) {\n        unconfigureAnchorEl();\n      } else {\n        configureAnchorEl();\n      }\n    }\n  });\n  onMounted(() => {\n    pickAnchorEl();\n    if (avoidEmit !== true && props.modelValue === true && anchorEl.value === null) {\n      emit('update:modelValue', false);\n    }\n  });\n  onBeforeUnmount(() => {\n    touchTimer !== null && clearTimeout(touchTimer);\n    unconfigureAnchorEl();\n  });\n  return {\n    anchorEl,\n    canShow,\n    anchorEvents\n  };\n}","map":{"version":3,"names":["ref","watch","onMounted","onBeforeUnmount","nextTick","getCurrentInstance","clearSelection","addEvt","cleanEvt","prevent","isKeyCode","useAnchorProps","target","default","noParentEvent","Boolean","contextMenu","showing","avoidEmit","configureAnchorEl","props","proxy","emit","anchorEl","touchTimer","canShow","evt","value","touches","length","anchorEvents","Object","assign","hide","toggle","qAnchorHandled","toggleKey","contextClick","show","mobileTouch","mobileCleanup","classList","add","setTimeout","remove","clearTimeout","context","evts","$q","platform","is","mobile","unconfigureAnchorEl","setAnchorEl","el","contains","parentNode","pickAnchorEl","$el","document","querySelector","err","console","error","val","modelValue"],"sources":["D:/LearnVueJS/Vue3/Projects/fa-sop-online/node_modules/quasar/src/composables/private/use-anchor.js"],"sourcesContent":["import { ref, watch, onMounted, onBeforeUnmount, nextTick, getCurrentInstance } from 'vue'\n\nimport { clearSelection } from '../../utils/private/selection.js'\nimport { addEvt, cleanEvt, prevent } from '../../utils/event.js'\nimport { isKeyCode } from '../../utils/private/key-composition.js'\n\nexport const useAnchorProps = {\n  target: {\n    default: true\n  },\n  noParentEvent: Boolean,\n  contextMenu: Boolean\n}\n\nexport default function ({\n  showing,\n  avoidEmit, // required for QPopupProxy (true)\n  configureAnchorEl // optional\n}) {\n  const { props, proxy, emit } = getCurrentInstance()\n\n  const anchorEl = ref(null)\n\n  let touchTimer = null\n\n  function canShow (evt) {\n    // abort with no parent configured or on multi-touch\n    return anchorEl.value === null\n      ? false\n      : (evt === void 0 || evt.touches === void 0 || evt.touches.length <= 1)\n  }\n\n  const anchorEvents = {}\n\n  if (configureAnchorEl === void 0) {\n    // default configureAnchorEl is designed for\n    // QMenu & QPopupProxy (which is why it's handled here)\n\n    Object.assign(anchorEvents, {\n      hide (evt) {\n        proxy.hide(evt)\n      },\n\n      toggle (evt) {\n        proxy.toggle(evt)\n        evt.qAnchorHandled = true\n      },\n\n      toggleKey (evt) {\n        isKeyCode(evt, 13) === true && anchorEvents.toggle(evt)\n      },\n\n      contextClick (evt) {\n        proxy.hide(evt)\n        prevent(evt)\n        nextTick(() => {\n          proxy.show(evt)\n          evt.qAnchorHandled = true\n        })\n      },\n\n      prevent,\n\n      mobileTouch (evt) {\n        anchorEvents.mobileCleanup(evt)\n\n        if (canShow(evt) !== true) {\n          return\n        }\n\n        proxy.hide(evt)\n        anchorEl.value.classList.add('non-selectable')\n\n        const target = evt.target\n        addEvt(anchorEvents, 'anchor', [\n          [ target, 'touchmove', 'mobileCleanup', 'passive' ],\n          [ target, 'touchend', 'mobileCleanup', 'passive' ],\n          [ target, 'touchcancel', 'mobileCleanup', 'passive' ],\n          [ anchorEl.value, 'contextmenu', 'prevent', 'notPassive' ]\n        ])\n\n        touchTimer = setTimeout(() => {\n          touchTimer = null\n          proxy.show(evt)\n          evt.qAnchorHandled = true\n        }, 300)\n      },\n\n      mobileCleanup (evt) {\n        anchorEl.value.classList.remove('non-selectable')\n\n        if (touchTimer !== null) {\n          clearTimeout(touchTimer)\n          touchTimer = null\n        }\n\n        if (showing.value === true && evt !== void 0) {\n          clearSelection()\n        }\n      }\n    })\n\n    configureAnchorEl = function (context = props.contextMenu) {\n      if (props.noParentEvent === true || anchorEl.value === null) { return }\n\n      let evts\n\n      if (context === true) {\n        if (proxy.$q.platform.is.mobile === true) {\n          evts = [\n            [ anchorEl.value, 'touchstart', 'mobileTouch', 'passive' ]\n          ]\n        }\n        else {\n          evts = [\n            [ anchorEl.value, 'mousedown', 'hide', 'passive' ],\n            [ anchorEl.value, 'contextmenu', 'contextClick', 'notPassive' ]\n          ]\n        }\n      }\n      else {\n        evts = [\n          [ anchorEl.value, 'click', 'toggle', 'passive' ],\n          [ anchorEl.value, 'keyup', 'toggleKey', 'passive' ]\n        ]\n      }\n\n      addEvt(anchorEvents, 'anchor', evts)\n    }\n  }\n\n  function unconfigureAnchorEl () {\n    cleanEvt(anchorEvents, 'anchor')\n  }\n\n  function setAnchorEl (el) {\n    anchorEl.value = el\n    while (anchorEl.value.classList.contains('q-anchor--skip')) {\n      anchorEl.value = anchorEl.value.parentNode\n    }\n    configureAnchorEl()\n  }\n\n  function pickAnchorEl () {\n    if (props.target === false || props.target === '' || proxy.$el.parentNode === null) {\n      anchorEl.value = null\n    }\n    else if (props.target === true) {\n      setAnchorEl(proxy.$el.parentNode)\n    }\n    else {\n      let el = props.target\n\n      if (typeof props.target === 'string') {\n        try {\n          el = document.querySelector(props.target)\n        }\n        catch (err) {\n          el = void 0\n        }\n      }\n\n      if (el !== void 0 && el !== null) {\n        anchorEl.value = el.$el || el\n        configureAnchorEl()\n      }\n      else {\n        anchorEl.value = null\n        console.error(`Anchor: target \"${ props.target }\" not found`)\n      }\n    }\n  }\n\n  watch(() => props.contextMenu, val => {\n    if (anchorEl.value !== null) {\n      unconfigureAnchorEl()\n      configureAnchorEl(val)\n    }\n  })\n\n  watch(() => props.target, () => {\n    if (anchorEl.value !== null) {\n      unconfigureAnchorEl()\n    }\n\n    pickAnchorEl()\n  })\n\n  watch(() => props.noParentEvent, val => {\n    if (anchorEl.value !== null) {\n      if (val === true) {\n        unconfigureAnchorEl()\n      }\n      else {\n        configureAnchorEl()\n      }\n    }\n  })\n\n  onMounted(() => {\n    pickAnchorEl()\n\n    if (avoidEmit !== true && props.modelValue === true && anchorEl.value === null) {\n      emit('update:modelValue', false)\n    }\n  })\n\n  onBeforeUnmount(() => {\n    touchTimer !== null && clearTimeout(touchTimer)\n    unconfigureAnchorEl()\n  })\n\n  return {\n    anchorEl,\n    canShow,\n    anchorEvents\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}