{"ast":null,"code":"import { openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-a80eac0c\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  id: \"pie-chart\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1);\n}","map":{"version":3,"names":["id","_createElementBlock","_hoisted_1"],"sources":["D:\\LearnVueJS\\Vue3\\Projects\\fa-sop-online\\src\\components\\FATPkanban\\StationYield.vue"],"sourcesContent":["<template>\r\n  <div id=\"pie-chart\"></div>\r\n</template>\r\n  \r\n  <script>\r\nimport GetOption from \"./Datas/stationYield\";\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      option: GetOption(),\r\n      myChart: undefined,\r\n      colors: [\r\n        \"#1478eb\",\r\n        \"green\",\r\n        \"orange\",\r\n        \"yellow\",\r\n        \"red\",\r\n        \"indigo\",\r\n        \"purple\",\r\n        \"#cccccc\",\r\n      ],\r\n    };\r\n  },\r\n  methods: {\r\n    DataUpdate(line) {\r\n      this.myChart.clear();\r\n      this.axios\r\n        .post(\"api/FATPKanban/GetYieldDetail\", line)\r\n        .then((res) => {\r\n          const [sr, grp] = this.GetSeries(res.data.data);\r\n          if (sr.length > 0) {\r\n            this.option.series = sr;\r\n            this.option.graphic = grp;\r\n            this.myChart.setOption(this.option);\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    GetSeries(data) {\r\n      const rs = [];\r\n      const grp = [];\r\n      const offset =\r\n        data.length > 0 ? Math.floor(this.myChart.getWidth() / data.length) : 1;\r\n      var labelFromatter = {\r\n        normal: {\r\n          color: function (params) {\r\n            if (params.value >= 99) {\r\n              return \"#04B404\";\r\n            } else if (params.value >= 97.5) {\r\n              return \"#0080FF\";\r\n            } else if (params.value >= 96) {\r\n              return \"#FE9A2E\";\r\n            } else {\r\n              return \"#FE2E2E\";\r\n            }\r\n          },\r\n          label: {\r\n            formatter: function (params) {\r\n              return params.value + \"%\";\r\n            },\r\n            textStyle: {\r\n              baseline: \"top\",\r\n            },\r\n            color: \"auto\",\r\n            fontSize: 20,\r\n            position: \"center\",\r\n          },\r\n        },\r\n      };\r\n      var labelTop = {\r\n        normal: {\r\n          label: {\r\n            show: true,\r\n            position: \"center\",\r\n            formatter: \"{b}\",\r\n            textStyle: {\r\n              baseline: \"bottom\",\r\n            },\r\n          },\r\n\r\n          labelLine: {\r\n            show: false,\r\n          },\r\n        },\r\n      };\r\n      var labelBottom = {\r\n        normal: {\r\n          color: \"#ccc\",\r\n          label: {\r\n            show: true,\r\n            textStyle: {\r\n              baseline: \"top\",\r\n            },\r\n            position: \"center\",\r\n          },\r\n          labelLine: {\r\n            show: false,\r\n          },\r\n        },\r\n        emphasis: {\r\n          color: \"rgba(0,0,0,0)\",\r\n        },\r\n      };\r\n      for (let id = 0; id < data.length; id++) {\r\n        const el = data[id];\r\n        grp.push({\r\n          type: \"text\",\r\n          style: {\r\n            text: el.PROCESS_NAME,\r\n            x: id == 0 ? id * offset + 50 : id * offset + 40,\r\n            y: 290,\r\n            fill: \"#fff\",\r\n            font: \"20px verdana\",\r\n          },\r\n        });\r\n        rs.push({\r\n          type: \"pie\",\r\n          center: [id == 0 ? id * offset + 80 : id * offset + 60, \"50%\"],\r\n          radius: [45, 60],\r\n          x: \"0%\",\r\n          itemStyle: labelFromatter,\r\n          data: [\r\n            {\r\n              name: \"pass\",\r\n              value: el.PERCENT,\r\n              itemStyle: labelTop,\r\n              label: { show: true, fontSize: 18 },\r\n            },\r\n            {\r\n              name: \"fail\",\r\n              value: 100 - el.PERCENT,\r\n              itemStyle: labelBottom,\r\n              label: { show: false, position: \"inside\" },\r\n            },\r\n          ],\r\n        });\r\n      }\r\n      return [rs, grp];\r\n    },\r\n  },\r\n  mounted() {\r\n    var dom = document.getElementById(\"pie-chart\");\r\n    this.myChart = this.$Echart.init(dom, null, {\r\n      renderer: \"canvas\",\r\n      useDirtyRect: false,\r\n    });\r\n\r\n    if (this.option && typeof this.option === \"object\") {\r\n      this.myChart.setOption(this.option);\r\n    }\r\n\r\n    setInterval(() => {\r\n      this.DataUpdate({ PDLINE_ID: \"10001\", DB: \"BU20\" });\r\n      window.addEventListener(\"resize\", this.myChart.resize);\r\n    }, 5000);\r\n  },\r\n};\r\n</script>\r\n  \r\n  <style lang=\"scss\" scoped>\r\n#pie-chart {\r\n  height: 40vh;\r\n  width: 100%;\r\n  overflow: hidden;\r\n}\r\n</style>"],"mappings":";;;EACOA,EAAE,EAAC;AAAW;;uBAAnBC,mBAAA,CAA0B,OAA1BC,UAA0B"},"metadata":{},"sourceType":"module","externalDependencies":[]}