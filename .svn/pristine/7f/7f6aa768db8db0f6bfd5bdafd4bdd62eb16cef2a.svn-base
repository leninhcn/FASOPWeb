{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { createCanvas, loadImage } from \"canvas\";\nexport default {\n  name: \"ImageMerging\",\n  data() {\n    return {\n      mergedImageUrl: \"#\"\n    };\n  },\n  mounted() {\n    this.axios.get(`api/chatapp/GetEmpAllGroup?emp_id=10003367`).then(async res => {\n      const lsrImg = [];\n      res.data[0].INFO.EMP_AVATAR.forEach((el, id) => {\n        if (id <= 3) {\n          lsrImg.push(el.AVATAR);\n        } else {\n          return;\n        }\n      });\n      this.mergedImageUrl = await this.ImageMerging(lsrImg);\n    }).catch(err => {\n      console.log(err);\n    });\n  },\n  methods: {\n    async ImageMerging(imgList) {\n      if (!imgList || imgList.lenght > 4) {\n        return \"#\";\n      }\n      const canvasWidth = 1000;\n      const canvasHeight = 1000;\n\n      // Tạo đối tượng canvas với kích thước tương ứng\n      let canvas = createCanvas(500, 500);\n      let ctx = canvas.getContext(\"2d\");\n      var lstSyncIMG = [];\n      let imgTemp = undefined;\n      const promises = [];\n      imgList.forEach(el => {\n        const promise = new Promise((innerResolve, innerReject) => {\n          try {\n            imgTemp = loadImage(`data:image/png;base64,${el}`);\n            ctx.drawImage(imgTemp, 0, 0, 500, 500);\n            var temp1 = loadImage(canvas.toDataURL(\"image/png\"));\n            lstSyncIMG.push(temp1);\n            innerResolve();\n          } catch (error) {\n            innerReject(error);\n          }\n        });\n        promises.push(promise);\n      });\n      Promise.all(promises).then(() => {\n        console.log(lstSyncIMG.length);\n        canvas = createCanvas(canvasWidth, canvasHeight);\n        ctx = canvas.getContext(\"2d\");\n        lstSyncIMG.forEach((el, idx) => {\n          console.log(idx);\n          switch (idx) {\n            case 0:\n              ctx.drawImage(el, 0, 0, 500, 500);\n              break;\n            case 1:\n              ctx.drawImage(el, 500, 0, 500, 500);\n              break;\n            case 2:\n              ctx.drawImage(el, 0, 500, 500, 500);\n              break;\n            case 3:\n              ctx.drawImage(el, 500, 500, 500, 500);\n              break;\n            default:\n              break;\n          }\n        });\n        return canvas.toDataURL(\"image/png\");\n      }).catch(error => {\n        console.log(error);\n      });\n\n      //   imgList.forEach(async (el) => {\n      //     imgTemp = await loadImage(`data:image/png;base64,${el}`);\n      //     ctx.drawImage(imgTemp, 0, 0, 500, 500);\n      //     var temp1 = await loadImage(canvas.toDataURL(\"image/png\"));\n      //     lstSyncIMG.push(temp1);\n      //   });\n    }\n  }\n};","map":{"version":3,"names":["createCanvas","loadImage","name","data","mergedImageUrl","mounted","axios","get","then","res","lsrImg","INFO","EMP_AVATAR","forEach","el","id","push","AVATAR","ImageMerging","catch","err","console","log","methods","imgList","lenght","canvasWidth","canvasHeight","canvas","ctx","getContext","lstSyncIMG","imgTemp","undefined","promises","promise","Promise","innerResolve","innerReject","drawImage","temp1","toDataURL","error","all","length","idx"],"sources":["D:\\LearnVueJS\\Vue3\\Projects\\fa-sop-online\\src\\components\\QMessage\\ImageMerging.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <img :src=\"mergedImageUrl\" alt=\"Merged Image\" />\r\n  </div>\r\n</template>\r\n  \r\n  <script>\r\nimport { createCanvas, loadImage } from \"canvas\";\r\n\r\nexport default {\r\n  name: \"ImageMerging\",\r\n  data() {\r\n    return {\r\n      mergedImageUrl: \"#\",\r\n    };\r\n  },\r\n  mounted() {\r\n    this.axios\r\n      .get(`api/chatapp/GetEmpAllGroup?emp_id=10003367`)\r\n      .then(async (res) => {\r\n        const lsrImg = [];\r\n        res.data[0].INFO.EMP_AVATAR.forEach((el, id) => {\r\n          if (id <= 3) {\r\n            lsrImg.push(el.AVATAR);\r\n          } else {\r\n            return;\r\n          }\r\n        });\r\n        this.mergedImageUrl = await this.ImageMerging(lsrImg);\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  },\r\n  methods: {\r\n    async ImageMerging(imgList) {\r\n      if (!imgList || imgList.lenght > 4) {\r\n        return \"#\";\r\n      }\r\n      const canvasWidth = 1000;\r\n      const canvasHeight = 1000;\r\n\r\n      // Tạo đối tượng canvas với kích thước tương ứng\r\n      let canvas = createCanvas(500, 500);\r\n      let ctx = canvas.getContext(\"2d\");\r\n      var lstSyncIMG = [];\r\n      let imgTemp = undefined;\r\n      const promises = [];\r\n\r\n      imgList.forEach((el) => {\r\n        const promise = new Promise((innerResolve, innerReject) => {\r\n          try {\r\n            imgTemp = loadImage(`data:image/png;base64,${el}`);\r\n            ctx.drawImage(imgTemp, 0, 0, 500, 500);\r\n            var temp1 = loadImage(canvas.toDataURL(\"image/png\"));\r\n            lstSyncIMG.push(temp1);\r\n            innerResolve();\r\n          } catch (error) {\r\n            innerReject(error);\r\n          }\r\n        });\r\n\r\n        promises.push(promise);\r\n      });\r\n\r\n      Promise.all(promises)\r\n        .then(() => {\r\n          console.log(lstSyncIMG.length);\r\n          canvas = createCanvas(canvasWidth, canvasHeight);\r\n          ctx = canvas.getContext(\"2d\");\r\n\r\n          lstSyncIMG.forEach((el, idx) => {\r\n            console.log(idx);\r\n            switch (idx) {\r\n              case 0:\r\n                ctx.drawImage(el, 0, 0, 500, 500);\r\n                break;\r\n              case 1:\r\n                ctx.drawImage(el, 500, 0, 500, 500);\r\n                break;\r\n              case 2:\r\n                ctx.drawImage(el, 0, 500, 500, 500);\r\n                break;\r\n              case 3:\r\n                ctx.drawImage(el, 500, 500, 500, 500);\r\n                break;\r\n              default:\r\n                break;\r\n            }\r\n          });\r\n          return canvas.toDataURL(\"image/png\");\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n        });\r\n\r\n      //   imgList.forEach(async (el) => {\r\n      //     imgTemp = await loadImage(`data:image/png;base64,${el}`);\r\n      //     ctx.drawImage(imgTemp, 0, 0, 500, 500);\r\n      //     var temp1 = await loadImage(canvas.toDataURL(\"image/png\"));\r\n      //     lstSyncIMG.push(temp1);\r\n      //   });\r\n    },\r\n  },\r\n};\r\n</script>\r\n  "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}