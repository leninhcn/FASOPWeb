{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { h, ref, computed, watch, onBeforeUpdate, onUpdated, onBeforeUnmount, nextTick, getCurrentInstance } from 'vue';\nimport QField from '../field/QField.js';\nimport QIcon from '../icon/QIcon.js';\nimport QChip from '../chip/QChip.js';\nimport QItem from '../item/QItem.js';\nimport QItemSection from '../item/QItemSection.js';\nimport QItemLabel from '../item/QItemLabel.js';\nimport QMenu from '../menu/QMenu.js';\nimport QDialog from '../dialog/QDialog.js';\nimport useField, { useFieldState, useFieldProps, useFieldEmits, fieldValueIsFilled } from '../../composables/private/use-field.js';\nimport { useVirtualScroll, useVirtualScrollProps } from '../virtual-scroll/use-virtual-scroll.js';\nimport { useFormProps, useFormInputNameAttr } from '../../composables/private/use-form.js';\nimport useKeyComposition from '../../composables/private/use-key-composition.js';\nimport { createComponent } from '../../utils/private/create.js';\nimport { isDeepEqual } from '../../utils/is.js';\nimport { stop, prevent, stopAndPrevent } from '../../utils/event.js';\nimport { normalizeToInterval } from '../../utils/format.js';\nimport { shouldIgnoreKey, isKeyCode } from '../../utils/private/key-composition.js';\nimport { hMergeSlot } from '../../utils/private/render.js';\nconst validateNewValueMode = v => ['add', 'add-unique', 'toggle'].includes(v);\nconst reEscapeList = '.*+?^${}()|[]\\\\';\nconst fieldPropsList = Object.keys(useFieldProps);\nexport default createComponent({\n  name: 'QSelect',\n  inheritAttrs: false,\n  props: {\n    ...useVirtualScrollProps,\n    ...useFormProps,\n    ...useFieldProps,\n    modelValue: {\n      required: true\n    },\n    multiple: Boolean,\n    displayValue: [String, Number],\n    displayValueHtml: Boolean,\n    dropdownIcon: String,\n    options: {\n      type: Array,\n      default: () => []\n    },\n    optionValue: [Function, String],\n    optionLabel: [Function, String],\n    optionDisable: [Function, String],\n    hideSelected: Boolean,\n    hideDropdownIcon: Boolean,\n    fillInput: Boolean,\n    maxValues: [Number, String],\n    optionsDense: Boolean,\n    optionsDark: {\n      type: Boolean,\n      default: null\n    },\n    optionsSelectedClass: String,\n    optionsHtml: Boolean,\n    optionsCover: Boolean,\n    menuShrink: Boolean,\n    menuAnchor: String,\n    menuSelf: String,\n    menuOffset: Array,\n    popupContentClass: String,\n    popupContentStyle: [String, Array, Object],\n    useInput: Boolean,\n    useChips: Boolean,\n    newValueMode: {\n      type: String,\n      validator: validateNewValueMode\n    },\n    mapOptions: Boolean,\n    emitValue: Boolean,\n    inputDebounce: {\n      type: [Number, String],\n      default: 500\n    },\n    inputClass: [Array, String, Object],\n    inputStyle: [Array, String, Object],\n    tabindex: {\n      type: [String, Number],\n      default: 0\n    },\n    autocomplete: String,\n    transitionShow: String,\n    transitionHide: String,\n    transitionDuration: [String, Number],\n    behavior: {\n      type: String,\n      validator: v => ['default', 'menu', 'dialog'].includes(v),\n      default: 'default'\n    },\n    virtualScrollItemSize: {\n      type: [Number, String],\n      default: void 0\n    },\n    onNewValue: Function,\n    onFilter: Function\n  },\n  emits: [...useFieldEmits, 'add', 'remove', 'inputValue', 'newValue', 'keyup', 'keypress', 'keydown', 'filterAbort'],\n  setup(props, {\n    slots,\n    emit\n  }) {\n    const {\n      proxy\n    } = getCurrentInstance();\n    const {\n      $q\n    } = proxy;\n    const menu = ref(false);\n    const dialog = ref(false);\n    const optionIndex = ref(-1);\n    const inputValue = ref('');\n    const dialogFieldFocused = ref(false);\n    const innerLoadingIndicator = ref(false);\n    let inputTimer = null,\n      innerValueCache,\n      hasDialog,\n      userInputValue,\n      filterId = null,\n      defaultInputValue,\n      transitionShowComputed,\n      searchBuffer,\n      searchBufferExp;\n    const inputRef = ref(null);\n    const targetRef = ref(null);\n    const menuRef = ref(null);\n    const dialogRef = ref(null);\n    const menuContentRef = ref(null);\n    const nameProp = useFormInputNameAttr(props);\n    const onComposition = useKeyComposition(onInput);\n    const virtualScrollLength = computed(() => Array.isArray(props.options) ? props.options.length : 0);\n    const virtualScrollItemSizeComputed = computed(() => props.virtualScrollItemSize === void 0 ? props.optionsDense === true ? 24 : 48 : props.virtualScrollItemSize);\n    const {\n      virtualScrollSliceRange,\n      virtualScrollSliceSizeComputed,\n      localResetVirtualScroll,\n      padVirtualScroll,\n      onVirtualScrollEvt,\n      scrollTo,\n      setVirtualScrollSize\n    } = useVirtualScroll({\n      virtualScrollLength,\n      getVirtualScrollTarget,\n      getVirtualScrollEl,\n      virtualScrollItemSizeComputed\n    });\n    const state = useFieldState();\n    const innerValue = computed(() => {\n      const mapNull = props.mapOptions === true && props.multiple !== true,\n        val = props.modelValue !== void 0 && (props.modelValue !== null || mapNull === true) ? props.multiple === true && Array.isArray(props.modelValue) ? props.modelValue : [props.modelValue] : [];\n      if (props.mapOptions === true && Array.isArray(props.options) === true) {\n        const cache = props.mapOptions === true && innerValueCache !== void 0 ? innerValueCache : [];\n        const values = val.map(v => getOption(v, cache));\n        return props.modelValue === null && mapNull === true ? values.filter(v => v !== null) : values;\n      }\n      return val;\n    });\n    const innerFieldProps = computed(() => {\n      const acc = {};\n      fieldPropsList.forEach(key => {\n        const val = props[key];\n        if (val !== void 0) {\n          acc[key] = val;\n        }\n      });\n      return acc;\n    });\n    const isOptionsDark = computed(() => props.optionsDark === null ? state.isDark.value : props.optionsDark);\n    const hasValue = computed(() => fieldValueIsFilled(innerValue.value));\n    const computedInputClass = computed(() => {\n      let cls = 'q-field__input q-placeholder col';\n      if (props.hideSelected === true || innerValue.value.length === 0) {\n        return [cls, props.inputClass];\n      }\n      cls += ' q-field__input--padding';\n      return props.inputClass === void 0 ? cls : [cls, props.inputClass];\n    });\n    const menuContentClass = computed(() => (props.virtualScrollHorizontal === true ? 'q-virtual-scroll--horizontal' : '') + (props.popupContentClass ? ' ' + props.popupContentClass : ''));\n    const noOptions = computed(() => virtualScrollLength.value === 0);\n    const selectedString = computed(() => innerValue.value.map(opt => getOptionLabel.value(opt)).join(', '));\n    const ariaCurrentValue = computed(() => props.displayValue !== void 0 ? props.displayValue : selectedString.value);\n    const needsHtmlFn = computed(() => props.optionsHtml === true ? () => true : opt => opt !== void 0 && opt !== null && opt.html === true);\n    const valueAsHtml = computed(() => props.displayValueHtml === true || props.displayValue === void 0 && (props.optionsHtml === true || innerValue.value.some(needsHtmlFn.value)));\n    const tabindex = computed(() => state.focused.value === true ? props.tabindex : -1);\n    const comboboxAttrs = computed(() => {\n      const attrs = {\n        tabindex: props.tabindex,\n        role: 'combobox',\n        'aria-label': props.label,\n        'aria-readonly': props.readonly === true ? 'true' : 'false',\n        'aria-autocomplete': props.useInput === true ? 'list' : 'none',\n        'aria-expanded': menu.value === true ? 'true' : 'false',\n        'aria-controls': `${state.targetUid.value}_lb`\n      };\n      if (optionIndex.value >= 0) {\n        attrs['aria-activedescendant'] = `${state.targetUid.value}_${optionIndex.value}`;\n      }\n      return attrs;\n    });\n    const listboxAttrs = computed(() => ({\n      id: `${state.targetUid.value}_lb`,\n      role: 'listbox',\n      'aria-multiselectable': props.multiple === true ? 'true' : 'false'\n    }));\n    const selectedScope = computed(() => {\n      return innerValue.value.map((opt, i) => ({\n        index: i,\n        opt,\n        html: needsHtmlFn.value(opt),\n        selected: true,\n        removeAtIndex: removeAtIndexAndFocus,\n        toggleOption,\n        tabindex: tabindex.value\n      }));\n    });\n    const optionScope = computed(() => {\n      if (virtualScrollLength.value === 0) {\n        return [];\n      }\n      const {\n        from,\n        to\n      } = virtualScrollSliceRange.value;\n      return props.options.slice(from, to).map((opt, i) => {\n        const disable = isOptionDisabled.value(opt) === true;\n        const index = from + i;\n        const itemProps = {\n          clickable: true,\n          active: false,\n          activeClass: computedOptionsSelectedClass.value,\n          manualFocus: true,\n          focused: false,\n          disable,\n          tabindex: -1,\n          dense: props.optionsDense,\n          dark: isOptionsDark.value,\n          role: 'option',\n          id: `${state.targetUid.value}_${index}`,\n          onClick: () => {\n            toggleOption(opt);\n          }\n        };\n        if (disable !== true) {\n          isOptionSelected(opt) === true && (itemProps.active = true);\n          optionIndex.value === index && (itemProps.focused = true);\n          itemProps['aria-selected'] = itemProps.active === true ? 'true' : 'false';\n          if ($q.platform.is.desktop === true) {\n            itemProps.onMousemove = () => {\n              menu.value === true && setOptionIndex(index);\n            };\n          }\n        }\n        return {\n          index,\n          opt,\n          html: needsHtmlFn.value(opt),\n          label: getOptionLabel.value(opt),\n          selected: itemProps.active,\n          focused: itemProps.focused,\n          toggleOption,\n          setOptionIndex,\n          itemProps\n        };\n      });\n    });\n    const dropdownArrowIcon = computed(() => props.dropdownIcon !== void 0 ? props.dropdownIcon : $q.iconSet.arrow.dropdown);\n    const squaredMenu = computed(() => props.optionsCover === false && props.outlined !== true && props.standout !== true && props.borderless !== true && props.rounded !== true);\n    const computedOptionsSelectedClass = computed(() => props.optionsSelectedClass !== void 0 ? props.optionsSelectedClass : props.color !== void 0 ? `text-${props.color}` : '');\n\n    // returns method to get value of an option;\n    // takes into account 'option-value' prop\n    const getOptionValue = computed(() => getPropValueFn(props.optionValue, 'value'));\n\n    // returns method to get label of an option;\n    // takes into account 'option-label' prop\n    const getOptionLabel = computed(() => getPropValueFn(props.optionLabel, 'label'));\n\n    // returns method to tell if an option is disabled;\n    // takes into account 'option-disable' prop\n    const isOptionDisabled = computed(() => getPropValueFn(props.optionDisable, 'disable'));\n    const innerOptionsValue = computed(() => innerValue.value.map(opt => getOptionValue.value(opt)));\n    const inputControlEvents = computed(() => {\n      const evt = {\n        onInput,\n        // Safari < 10.2 & UIWebView doesn't fire compositionend when\n        // switching focus before confirming composition choice\n        // this also fixes the issue where some browsers e.g. iOS Chrome\n        // fires \"change\" instead of \"input\" on autocomplete.\n        onChange: onComposition,\n        onKeydown: onTargetKeydown,\n        onKeyup: onTargetAutocomplete,\n        onKeypress: onTargetKeypress,\n        onFocus: selectInputText,\n        onClick(e) {\n          hasDialog === true && stop(e);\n        }\n      };\n      evt.onCompositionstart = evt.onCompositionupdate = evt.onCompositionend = onComposition;\n      return evt;\n    });\n    watch(innerValue, val => {\n      innerValueCache = val;\n      if (props.useInput === true && props.fillInput === true && props.multiple !== true\n      // Prevent re-entering in filter while filtering\n      // Also prevent clearing inputValue while filtering\n      && state.innerLoading.value !== true && (dialog.value !== true && menu.value !== true || hasValue.value !== true)) {\n        userInputValue !== true && resetInputValue();\n        if (dialog.value === true || menu.value === true) {\n          filter('');\n        }\n      }\n    }, {\n      immediate: true\n    });\n    watch(() => props.fillInput, resetInputValue);\n    watch(menu, updateMenu);\n    watch(virtualScrollLength, rerenderMenu);\n    function getEmittingOptionValue(opt) {\n      return props.emitValue === true ? getOptionValue.value(opt) : opt;\n    }\n    function removeAtIndex(index) {\n      if (index > -1 && index < innerValue.value.length) {\n        if (props.multiple === true) {\n          const model = props.modelValue.slice();\n          emit('remove', {\n            index,\n            value: model.splice(index, 1)[0]\n          });\n          emit('update:modelValue', model);\n        } else {\n          emit('update:modelValue', null);\n        }\n      }\n    }\n    function removeAtIndexAndFocus(index) {\n      removeAtIndex(index);\n      state.focus();\n    }\n    function add(opt, unique) {\n      const val = getEmittingOptionValue(opt);\n      if (props.multiple !== true) {\n        props.fillInput === true && updateInputValue(getOptionLabel.value(opt), true, true);\n        emit('update:modelValue', val);\n        return;\n      }\n      if (innerValue.value.length === 0) {\n        emit('add', {\n          index: 0,\n          value: val\n        });\n        emit('update:modelValue', props.multiple === true ? [val] : val);\n        return;\n      }\n      if (unique === true && isOptionSelected(opt) === true) {\n        return;\n      }\n      if (props.maxValues !== void 0 && props.modelValue.length >= props.maxValues) {\n        return;\n      }\n      const model = props.modelValue.slice();\n      emit('add', {\n        index: model.length,\n        value: val\n      });\n      model.push(val);\n      emit('update:modelValue', model);\n    }\n    function toggleOption(opt, keepOpen) {\n      if (state.editable.value !== true || opt === void 0 || isOptionDisabled.value(opt) === true) {\n        return;\n      }\n      const optValue = getOptionValue.value(opt);\n      if (props.multiple !== true) {\n        if (keepOpen !== true) {\n          updateInputValue(props.fillInput === true ? getOptionLabel.value(opt) : '', true, true);\n          hidePopup();\n        }\n        targetRef.value !== null && targetRef.value.focus();\n        if (innerValue.value.length === 0 || isDeepEqual(getOptionValue.value(innerValue.value[0]), optValue) !== true) {\n          emit('update:modelValue', props.emitValue === true ? optValue : opt);\n        }\n        return;\n      }\n      (hasDialog !== true || dialogFieldFocused.value === true) && state.focus();\n      selectInputText();\n      if (innerValue.value.length === 0) {\n        const val = props.emitValue === true ? optValue : opt;\n        emit('add', {\n          index: 0,\n          value: val\n        });\n        emit('update:modelValue', props.multiple === true ? [val] : val);\n        return;\n      }\n      const model = props.modelValue.slice(),\n        index = innerOptionsValue.value.findIndex(v => isDeepEqual(v, optValue));\n      if (index > -1) {\n        emit('remove', {\n          index,\n          value: model.splice(index, 1)[0]\n        });\n      } else {\n        if (props.maxValues !== void 0 && model.length >= props.maxValues) {\n          return;\n        }\n        const val = props.emitValue === true ? optValue : opt;\n        emit('add', {\n          index: model.length,\n          value: val\n        });\n        model.push(val);\n      }\n      emit('update:modelValue', model);\n    }\n    function setOptionIndex(index) {\n      if ($q.platform.is.desktop !== true) {\n        return;\n      }\n      const val = index > -1 && index < virtualScrollLength.value ? index : -1;\n      if (optionIndex.value !== val) {\n        optionIndex.value = val;\n      }\n    }\n    function moveOptionSelection(offset = 1, skipInputValue) {\n      if (menu.value === true) {\n        let index = optionIndex.value;\n        do {\n          index = normalizeToInterval(index + offset, -1, virtualScrollLength.value - 1);\n        } while (index !== -1 && index !== optionIndex.value && isOptionDisabled.value(props.options[index]) === true);\n        if (optionIndex.value !== index) {\n          setOptionIndex(index);\n          scrollTo(index);\n          if (skipInputValue !== true && props.useInput === true && props.fillInput === true) {\n            setInputValue(index >= 0 ? getOptionLabel.value(props.options[index]) : defaultInputValue);\n          }\n        }\n      }\n    }\n    function getOption(value, valueCache) {\n      const fn = opt => isDeepEqual(getOptionValue.value(opt), value);\n      return props.options.find(fn) || valueCache.find(fn) || value;\n    }\n    function getPropValueFn(propValue, defaultVal) {\n      const val = propValue !== void 0 ? propValue : defaultVal;\n      return typeof val === 'function' ? val : opt => opt !== null && typeof opt === 'object' && val in opt ? opt[val] : opt;\n    }\n    function isOptionSelected(opt) {\n      const val = getOptionValue.value(opt);\n      return innerOptionsValue.value.find(v => isDeepEqual(v, val)) !== void 0;\n    }\n    function selectInputText(e) {\n      if (props.useInput === true && targetRef.value !== null && (e === void 0 || targetRef.value === e.target && e.target.value === selectedString.value)) {\n        targetRef.value.select();\n      }\n    }\n    function onTargetKeyup(e) {\n      // if ESC and we have an opened menu\n      // then stop propagation (might be caught by a QDialog\n      // and so it will also close the QDialog, which is wrong)\n      if (isKeyCode(e, 27) === true && menu.value === true) {\n        stop(e);\n        // on ESC we need to close the dialog also\n        hidePopup();\n        resetInputValue();\n      }\n      emit('keyup', e);\n    }\n    function onTargetAutocomplete(e) {\n      const {\n        value\n      } = e.target;\n      if (e.keyCode !== void 0) {\n        onTargetKeyup(e);\n        return;\n      }\n      e.target.value = '';\n      if (inputTimer !== null) {\n        clearTimeout(inputTimer);\n        inputTimer = null;\n      }\n      resetInputValue();\n      if (typeof value === 'string' && value.length !== 0) {\n        const needle = value.toLocaleLowerCase();\n        const findFn = extractFn => {\n          const option = props.options.find(opt => extractFn.value(opt).toLocaleLowerCase() === needle);\n          if (option === void 0) {\n            return false;\n          }\n          if (innerValue.value.indexOf(option) === -1) {\n            toggleOption(option);\n          } else {\n            hidePopup();\n          }\n          return true;\n        };\n        const fillFn = afterFilter => {\n          if (findFn(getOptionValue) === true) {\n            return;\n          }\n          if (findFn(getOptionLabel) === true || afterFilter === true) {\n            return;\n          }\n          filter(value, true, () => fillFn(true));\n        };\n        fillFn();\n      } else {\n        state.clearValue(e);\n      }\n    }\n    function onTargetKeypress(e) {\n      emit('keypress', e);\n    }\n    function onTargetKeydown(e) {\n      emit('keydown', e);\n      if (shouldIgnoreKey(e) === true) {\n        return;\n      }\n      const newValueModeValid = inputValue.value.length !== 0 && (props.newValueMode !== void 0 || props.onNewValue !== void 0);\n      const tabShouldSelect = e.shiftKey !== true && props.multiple !== true && (optionIndex.value > -1 || newValueModeValid === true);\n\n      // escape\n      if (e.keyCode === 27) {\n        prevent(e); // prevent clearing the inputValue\n        return;\n      }\n\n      // tab\n      if (e.keyCode === 9 && tabShouldSelect === false) {\n        closeMenu();\n        return;\n      }\n      if (e.target === void 0 || e.target.id !== state.targetUid.value) {\n        return;\n      }\n\n      // down\n      if (e.keyCode === 40 && state.innerLoading.value !== true && menu.value === false) {\n        stopAndPrevent(e);\n        showPopup();\n        return;\n      }\n\n      // backspace\n      if (e.keyCode === 8 && props.hideSelected !== true && inputValue.value.length === 0) {\n        if (props.multiple === true && Array.isArray(props.modelValue) === true) {\n          removeAtIndex(props.modelValue.length - 1);\n        } else if (props.multiple !== true && props.modelValue !== null) {\n          emit('update:modelValue', null);\n        }\n        return;\n      }\n\n      // home, end - 36, 35\n      if ((e.keyCode === 35 || e.keyCode === 36) && (typeof inputValue.value !== 'string' || inputValue.value.length === 0)) {\n        stopAndPrevent(e);\n        optionIndex.value = -1;\n        moveOptionSelection(e.keyCode === 36 ? 1 : -1, props.multiple);\n      }\n\n      // pg up, pg down - 33, 34\n      if ((e.keyCode === 33 || e.keyCode === 34) && virtualScrollSliceSizeComputed.value !== void 0) {\n        stopAndPrevent(e);\n        optionIndex.value = Math.max(-1, Math.min(virtualScrollLength.value, optionIndex.value + (e.keyCode === 33 ? -1 : 1) * virtualScrollSliceSizeComputed.value.view));\n        moveOptionSelection(e.keyCode === 33 ? 1 : -1, props.multiple);\n      }\n\n      // up, down\n      if (e.keyCode === 38 || e.keyCode === 40) {\n        stopAndPrevent(e);\n        moveOptionSelection(e.keyCode === 38 ? -1 : 1, props.multiple);\n      }\n      const optionsLength = virtualScrollLength.value;\n\n      // clear search buffer if expired\n      if (searchBuffer === void 0 || searchBufferExp < Date.now()) {\n        searchBuffer = '';\n      }\n\n      // keyboard search when not having use-input\n      if (optionsLength > 0 && props.useInput !== true && e.key !== void 0 && e.key.length === 1 // printable char\n      && e.altKey === false // not kbd shortcut\n      && e.ctrlKey === false // not kbd shortcut\n      && e.metaKey === false // not kbd shortcut, especially on macOS with Command key\n      && (e.keyCode !== 32 || searchBuffer.length !== 0) // space in middle of search\n      ) {\n        menu.value !== true && showPopup(e);\n        const char = e.key.toLocaleLowerCase(),\n          keyRepeat = searchBuffer.length === 1 && searchBuffer[0] === char;\n        searchBufferExp = Date.now() + 1500;\n        if (keyRepeat === false) {\n          stopAndPrevent(e);\n          searchBuffer += char;\n        }\n        const searchRe = new RegExp('^' + searchBuffer.split('').map(l => reEscapeList.indexOf(l) > -1 ? '\\\\' + l : l).join('.*'), 'i');\n        let index = optionIndex.value;\n        if (keyRepeat === true || index < 0 || searchRe.test(getOptionLabel.value(props.options[index])) !== true) {\n          do {\n            index = normalizeToInterval(index + 1, -1, optionsLength - 1);\n          } while (index !== optionIndex.value && (isOptionDisabled.value(props.options[index]) === true || searchRe.test(getOptionLabel.value(props.options[index])) !== true));\n        }\n        if (optionIndex.value !== index) {\n          nextTick(() => {\n            setOptionIndex(index);\n            scrollTo(index);\n            if (index >= 0 && props.useInput === true && props.fillInput === true) {\n              setInputValue(getOptionLabel.value(props.options[index]));\n            }\n          });\n        }\n        return;\n      }\n\n      // enter, space (when not using use-input and not in search), or tab (when not using multiple and option selected)\n      // same target is checked above\n      if (e.keyCode !== 13 && (e.keyCode !== 32 || props.useInput === true || searchBuffer !== '') && (e.keyCode !== 9 || tabShouldSelect === false)) {\n        return;\n      }\n      e.keyCode !== 9 && stopAndPrevent(e);\n      if (optionIndex.value > -1 && optionIndex.value < optionsLength) {\n        toggleOption(props.options[optionIndex.value]);\n        return;\n      }\n      if (newValueModeValid === true) {\n        const done = (val, mode) => {\n          if (mode) {\n            if (validateNewValueMode(mode) !== true) {\n              return;\n            }\n          } else {\n            mode = props.newValueMode;\n          }\n          if (val === void 0 || val === null) {\n            return;\n          }\n          updateInputValue('', props.multiple !== true, true);\n          const fn = mode === 'toggle' ? toggleOption : add;\n          fn(val, mode === 'add-unique');\n          if (props.multiple !== true) {\n            targetRef.value !== null && targetRef.value.focus();\n            hidePopup();\n          }\n        };\n        if (props.onNewValue !== void 0) {\n          emit('newValue', inputValue.value, done);\n        } else {\n          done(inputValue.value);\n        }\n        if (props.multiple !== true) {\n          return;\n        }\n      }\n      if (menu.value === true) {\n        closeMenu();\n      } else if (state.innerLoading.value !== true) {\n        showPopup();\n      }\n    }\n    function getVirtualScrollEl() {\n      return hasDialog === true ? menuContentRef.value : menuRef.value !== null && menuRef.value.contentEl !== null ? menuRef.value.contentEl : void 0;\n    }\n    function getVirtualScrollTarget() {\n      return getVirtualScrollEl();\n    }\n    function getSelection() {\n      if (props.hideSelected === true) {\n        return [];\n      }\n      if (slots['selected-item'] !== void 0) {\n        return selectedScope.value.map(scope => slots['selected-item'](scope)).slice();\n      }\n      if (slots.selected !== void 0) {\n        return [].concat(slots.selected());\n      }\n      if (props.useChips === true) {\n        return selectedScope.value.map((scope, i) => h(QChip, {\n          key: 'option-' + i,\n          removable: state.editable.value === true && isOptionDisabled.value(scope.opt) !== true,\n          dense: true,\n          textColor: props.color,\n          tabindex: tabindex.value,\n          onRemove() {\n            scope.removeAtIndex(i);\n          }\n        }, () => h('span', {\n          class: 'ellipsis',\n          [scope.html === true ? 'innerHTML' : 'textContent']: getOptionLabel.value(scope.opt)\n        })));\n      }\n      return [h('span', {\n        [valueAsHtml.value === true ? 'innerHTML' : 'textContent']: ariaCurrentValue.value\n      })];\n    }\n    function getAllOptions() {\n      if (noOptions.value === true) {\n        return slots['no-option'] !== void 0 ? slots['no-option']({\n          inputValue: inputValue.value\n        }) : void 0;\n      }\n      const fn = slots.option !== void 0 ? slots.option : scope => {\n        return h(QItem, {\n          key: scope.index,\n          ...scope.itemProps\n        }, () => {\n          return h(QItemSection, () => h(QItemLabel, () => h('span', {\n            [scope.html === true ? 'innerHTML' : 'textContent']: scope.label\n          })));\n        });\n      };\n      let options = padVirtualScroll('div', optionScope.value.map(fn));\n      if (slots['before-options'] !== void 0) {\n        options = slots['before-options']().concat(options);\n      }\n      return hMergeSlot(slots['after-options'], options);\n    }\n    function getInput(fromDialog, isTarget) {\n      const attrs = isTarget === true ? {\n        ...comboboxAttrs.value,\n        ...state.splitAttrs.attributes.value\n      } : void 0;\n      const data = {\n        ref: isTarget === true ? targetRef : void 0,\n        key: 'i_t',\n        class: computedInputClass.value,\n        style: props.inputStyle,\n        value: inputValue.value !== void 0 ? inputValue.value : '',\n        // required for Android in order to show ENTER key when in form\n        type: 'search',\n        ...attrs,\n        id: isTarget === true ? state.targetUid.value : void 0,\n        maxlength: props.maxlength,\n        autocomplete: props.autocomplete,\n        'data-autofocus': fromDialog === true || props.autofocus === true || void 0,\n        disabled: props.disable === true,\n        readonly: props.readonly === true,\n        ...inputControlEvents.value\n      };\n      if (fromDialog !== true && hasDialog === true) {\n        if (Array.isArray(data.class) === true) {\n          data.class = [...data.class, 'no-pointer-events'];\n        } else {\n          data.class += ' no-pointer-events';\n        }\n      }\n      return h('input', data);\n    }\n    function onInput(e) {\n      if (inputTimer !== null) {\n        clearTimeout(inputTimer);\n        inputTimer = null;\n      }\n      if (e && e.target && e.target.qComposing === true) {\n        return;\n      }\n      setInputValue(e.target.value || '');\n      // mark it here as user input so that if updateInputValue is called\n      // before filter is called the indicator is reset\n      userInputValue = true;\n      defaultInputValue = inputValue.value;\n      if (state.focused.value !== true && (hasDialog !== true || dialogFieldFocused.value === true)) {\n        state.focus();\n      }\n      if (props.onFilter !== void 0) {\n        inputTimer = setTimeout(() => {\n          inputTimer = null;\n          filter(inputValue.value);\n        }, props.inputDebounce);\n      }\n    }\n    function setInputValue(val) {\n      if (inputValue.value !== val) {\n        inputValue.value = val;\n        emit('inputValue', val);\n      }\n    }\n    function updateInputValue(val, noFiltering, internal) {\n      userInputValue = internal !== true;\n      if (props.useInput === true) {\n        setInputValue(val);\n        if (noFiltering === true || internal !== true) {\n          defaultInputValue = val;\n        }\n        noFiltering !== true && filter(val);\n      }\n    }\n    function filter(val, keepClosed, afterUpdateFn) {\n      if (props.onFilter === void 0 || keepClosed !== true && state.focused.value !== true) {\n        return;\n      }\n      if (state.innerLoading.value === true) {\n        emit('filterAbort');\n      } else {\n        state.innerLoading.value = true;\n        innerLoadingIndicator.value = true;\n      }\n      if (val !== '' && props.multiple !== true && innerValue.value.length !== 0 && userInputValue !== true && val === getOptionLabel.value(innerValue.value[0])) {\n        val = '';\n      }\n      const localFilterId = setTimeout(() => {\n        menu.value === true && (menu.value = false);\n      }, 10);\n      filterId !== null && clearTimeout(filterId);\n      filterId = localFilterId;\n      emit('filter', val, (fn, afterFn) => {\n        if ((keepClosed === true || state.focused.value === true) && filterId === localFilterId) {\n          clearTimeout(filterId);\n          typeof fn === 'function' && fn();\n\n          // hide indicator to allow arrow to animate\n          innerLoadingIndicator.value = false;\n          nextTick(() => {\n            state.innerLoading.value = false;\n            if (state.editable.value === true) {\n              if (keepClosed === true) {\n                menu.value === true && hidePopup();\n              } else if (menu.value === true) {\n                updateMenu(true);\n              } else {\n                menu.value = true;\n              }\n            }\n            typeof afterFn === 'function' && nextTick(() => {\n              afterFn(proxy);\n            });\n            typeof afterUpdateFn === 'function' && nextTick(() => {\n              afterUpdateFn(proxy);\n            });\n          });\n        }\n      }, () => {\n        if (state.focused.value === true && filterId === localFilterId) {\n          clearTimeout(filterId);\n          state.innerLoading.value = false;\n          innerLoadingIndicator.value = false;\n        }\n        menu.value === true && (menu.value = false);\n      });\n    }\n    function getMenu() {\n      return h(QMenu, {\n        ref: menuRef,\n        class: menuContentClass.value,\n        style: props.popupContentStyle,\n        modelValue: menu.value,\n        fit: props.menuShrink !== true,\n        cover: props.optionsCover === true && noOptions.value !== true && props.useInput !== true,\n        anchor: props.menuAnchor,\n        self: props.menuSelf,\n        offset: props.menuOffset,\n        dark: isOptionsDark.value,\n        noParentEvent: true,\n        noRefocus: true,\n        noFocus: true,\n        square: squaredMenu.value,\n        transitionShow: props.transitionShow,\n        transitionHide: props.transitionHide,\n        transitionDuration: props.transitionDuration,\n        separateClosePopup: true,\n        ...listboxAttrs.value,\n        onScrollPassive: onVirtualScrollEvt,\n        onBeforeShow: onControlPopupShow,\n        onBeforeHide: onMenuBeforeHide,\n        onShow: onMenuShow\n      }, getAllOptions);\n    }\n    function onMenuBeforeHide(e) {\n      onControlPopupHide(e);\n      closeMenu();\n    }\n    function onMenuShow() {\n      setVirtualScrollSize();\n    }\n    function onDialogFieldFocus(e) {\n      stop(e);\n      targetRef.value !== null && targetRef.value.focus();\n      dialogFieldFocused.value = true;\n      window.scrollTo(window.pageXOffset || window.scrollX || document.body.scrollLeft || 0, 0);\n    }\n    function onDialogFieldBlur(e) {\n      stop(e);\n      nextTick(() => {\n        dialogFieldFocused.value = false;\n      });\n    }\n    function getDialog() {\n      const content = [h(QField, {\n        class: `col-auto ${state.fieldClass.value}`,\n        ...innerFieldProps.value,\n        for: state.targetUid.value,\n        dark: isOptionsDark.value,\n        square: true,\n        loading: innerLoadingIndicator.value,\n        itemAligned: false,\n        filled: true,\n        stackLabel: inputValue.value.length !== 0,\n        ...state.splitAttrs.listeners.value,\n        onFocus: onDialogFieldFocus,\n        onBlur: onDialogFieldBlur\n      }, {\n        ...slots,\n        rawControl: () => state.getControl(true),\n        before: void 0,\n        after: void 0\n      })];\n      menu.value === true && content.push(h('div', {\n        ref: menuContentRef,\n        class: menuContentClass.value + ' scroll',\n        style: props.popupContentStyle,\n        ...listboxAttrs.value,\n        onClick: prevent,\n        onScrollPassive: onVirtualScrollEvt\n      }, getAllOptions()));\n      return h(QDialog, {\n        ref: dialogRef,\n        modelValue: dialog.value,\n        position: props.useInput === true ? 'top' : void 0,\n        transitionShow: transitionShowComputed,\n        transitionHide: props.transitionHide,\n        transitionDuration: props.transitionDuration,\n        onBeforeShow: onControlPopupShow,\n        onBeforeHide: onDialogBeforeHide,\n        onHide: onDialogHide,\n        onShow: onDialogShow\n      }, () => h('div', {\n        class: 'q-select__dialog' + (isOptionsDark.value === true ? ' q-select__dialog--dark q-dark' : '') + (dialogFieldFocused.value === true ? ' q-select__dialog--focused' : '')\n      }, content));\n    }\n    function onDialogBeforeHide(e) {\n      onControlPopupHide(e);\n      if (dialogRef.value !== null) {\n        dialogRef.value.__updateRefocusTarget(state.rootRef.value.querySelector('.q-field__native > [tabindex]:last-child'));\n      }\n      state.focused.value = false;\n    }\n    function onDialogHide(e) {\n      hidePopup();\n      state.focused.value === false && emit('blur', e);\n      resetInputValue();\n    }\n    function onDialogShow() {\n      const el = document.activeElement;\n      if ((el === null || el.id !== state.targetUid.value) && targetRef.value !== null && targetRef.value !== el) {\n        targetRef.value.focus();\n      }\n      setVirtualScrollSize();\n    }\n    function closeMenu() {\n      if (dialog.value === true) {\n        return;\n      }\n      optionIndex.value = -1;\n      if (menu.value === true) {\n        menu.value = false;\n      }\n      if (state.focused.value === false) {\n        if (filterId !== null) {\n          clearTimeout(filterId);\n          filterId = null;\n        }\n        if (state.innerLoading.value === true) {\n          emit('filterAbort');\n          state.innerLoading.value = false;\n          innerLoadingIndicator.value = false;\n        }\n      }\n    }\n    function showPopup(e) {\n      if (state.editable.value !== true) {\n        return;\n      }\n      if (hasDialog === true) {\n        state.onControlFocusin(e);\n        dialog.value = true;\n        nextTick(() => {\n          state.focus();\n        });\n      } else {\n        state.focus();\n      }\n      if (props.onFilter !== void 0) {\n        filter(inputValue.value);\n      } else if (noOptions.value !== true || slots['no-option'] !== void 0) {\n        menu.value = true;\n      }\n    }\n    function hidePopup() {\n      dialog.value = false;\n      closeMenu();\n    }\n    function resetInputValue() {\n      props.useInput === true && updateInputValue(props.multiple !== true && props.fillInput === true && innerValue.value.length !== 0 ? getOptionLabel.value(innerValue.value[0]) || '' : '', true, true);\n    }\n    function updateMenu(show) {\n      let optionIndex = -1;\n      if (show === true) {\n        if (innerValue.value.length !== 0) {\n          const val = getOptionValue.value(innerValue.value[0]);\n          optionIndex = props.options.findIndex(v => isDeepEqual(getOptionValue.value(v), val));\n        }\n        localResetVirtualScroll(optionIndex);\n      }\n      setOptionIndex(optionIndex);\n    }\n    function rerenderMenu(newLength, oldLength) {\n      if (menu.value === true && state.innerLoading.value === false) {\n        localResetVirtualScroll(-1, true);\n        nextTick(() => {\n          if (menu.value === true && state.innerLoading.value === false) {\n            if (newLength > oldLength) {\n              localResetVirtualScroll();\n            } else {\n              updateMenu(true);\n            }\n          }\n        });\n      }\n    }\n    function updateMenuPosition() {\n      if (dialog.value === false && menuRef.value !== null) {\n        menuRef.value.updatePosition();\n      }\n    }\n    function onControlPopupShow(e) {\n      e !== void 0 && stop(e);\n      emit('popupShow', e);\n      state.hasPopupOpen = true;\n      state.onControlFocusin(e);\n    }\n    function onControlPopupHide(e) {\n      e !== void 0 && stop(e);\n      emit('popupHide', e);\n      state.hasPopupOpen = false;\n      state.onControlFocusout(e);\n    }\n    function updatePreState() {\n      hasDialog = $q.platform.is.mobile !== true && props.behavior !== 'dialog' ? false : props.behavior !== 'menu' && (props.useInput === true ? slots['no-option'] !== void 0 || props.onFilter !== void 0 || noOptions.value === false : true);\n      transitionShowComputed = $q.platform.is.ios === true && hasDialog === true && props.useInput === true ? 'fade' : props.transitionShow;\n    }\n    onBeforeUpdate(updatePreState);\n    onUpdated(updateMenuPosition);\n    updatePreState();\n    onBeforeUnmount(() => {\n      inputTimer !== null && clearTimeout(inputTimer);\n    });\n\n    // expose public methods\n    Object.assign(proxy, {\n      showPopup,\n      hidePopup,\n      removeAtIndex,\n      add,\n      toggleOption,\n      getOptionIndex: () => optionIndex.value,\n      setOptionIndex,\n      moveOptionSelection,\n      filter,\n      updateMenuPosition,\n      updateInputValue,\n      isOptionSelected,\n      getEmittingOptionValue,\n      isOptionDisabled: (...args) => isOptionDisabled.value.apply(null, args) === true,\n      getOptionValue: (...args) => getOptionValue.value.apply(null, args),\n      getOptionLabel: (...args) => getOptionLabel.value.apply(null, args)\n    });\n    Object.assign(state, {\n      innerValue,\n      fieldClass: computed(() => `q-select q-field--auto-height q-select--with${props.useInput !== true ? 'out' : ''}-input` + ` q-select--with${props.useChips !== true ? 'out' : ''}-chips` + ` q-select--${props.multiple === true ? 'multiple' : 'single'}`),\n      inputRef,\n      targetRef,\n      hasValue,\n      showPopup,\n      floatingLabel: computed(() => props.hideSelected !== true && hasValue.value === true || typeof inputValue.value === 'number' || inputValue.value.length !== 0 || fieldValueIsFilled(props.displayValue)),\n      getControlChild: () => {\n        if (state.editable.value !== false && (dialog.value === true // dialog always has menu displayed, so need to render it\n        || noOptions.value !== true || slots['no-option'] !== void 0)) {\n          return hasDialog === true ? getDialog() : getMenu();\n        } else if (state.hasPopupOpen === true) {\n          // explicitly set it otherwise TAB will not blur component\n          state.hasPopupOpen = false;\n        }\n      },\n      controlEvents: {\n        onFocusin(e) {\n          state.onControlFocusin(e);\n        },\n        onFocusout(e) {\n          state.onControlFocusout(e, () => {\n            resetInputValue();\n            closeMenu();\n          });\n        },\n        onClick(e) {\n          // label from QField will propagate click on the input\n          prevent(e);\n          if (hasDialog !== true && menu.value === true) {\n            closeMenu();\n            targetRef.value !== null && targetRef.value.focus();\n            return;\n          }\n          showPopup(e);\n        }\n      },\n      getControl: fromDialog => {\n        const child = getSelection();\n        const isTarget = fromDialog === true || dialog.value !== true || hasDialog !== true;\n        if (props.useInput === true) {\n          child.push(getInput(fromDialog, isTarget));\n        }\n        // there can be only one (when dialog is opened the control in dialog should be target)\n        else if (state.editable.value === true) {\n          const attrs = isTarget === true ? comboboxAttrs.value : void 0;\n          child.push(h('input', {\n            ref: isTarget === true ? targetRef : void 0,\n            key: 'd_t',\n            class: 'q-select__focus-target',\n            id: isTarget === true ? state.targetUid.value : void 0,\n            value: ariaCurrentValue.value,\n            readonly: true,\n            'data-autofocus': fromDialog === true || props.autofocus === true || void 0,\n            ...attrs,\n            onKeydown: onTargetKeydown,\n            onKeyup: onTargetKeyup,\n            onKeypress: onTargetKeypress\n          }));\n          if (isTarget === true && typeof props.autocomplete === 'string' && props.autocomplete.length !== 0) {\n            child.push(h('input', {\n              class: 'q-select__autocomplete-input',\n              autocomplete: props.autocomplete,\n              tabindex: -1,\n              onKeyup: onTargetAutocomplete\n            }));\n          }\n        }\n        if (nameProp.value !== void 0 && props.disable !== true && innerOptionsValue.value.length !== 0) {\n          const opts = innerOptionsValue.value.map(value => h('option', {\n            value,\n            selected: true\n          }));\n          child.push(h('select', {\n            class: 'hidden',\n            name: nameProp.value,\n            multiple: props.multiple\n          }, opts));\n        }\n        const attrs = props.useInput === true || isTarget !== true ? void 0 : state.splitAttrs.attributes.value;\n        return h('div', {\n          class: 'q-field__native row items-center',\n          ...attrs,\n          ...state.splitAttrs.listeners.value\n        }, child);\n      },\n      getInnerAppend: () => props.loading !== true && innerLoadingIndicator.value !== true && props.hideDropdownIcon !== true ? [h(QIcon, {\n        class: 'q-select__dropdown-icon' + (menu.value === true ? ' rotate-180' : ''),\n        name: dropdownArrowIcon.value\n      })] : null\n    });\n    return useField(state);\n  }\n});","map":{"version":3,"names":["h","ref","computed","watch","onBeforeUpdate","onUpdated","onBeforeUnmount","nextTick","getCurrentInstance","QField","QIcon","QChip","QItem","QItemSection","QItemLabel","QMenu","QDialog","useField","useFieldState","useFieldProps","useFieldEmits","fieldValueIsFilled","useVirtualScroll","useVirtualScrollProps","useFormProps","useFormInputNameAttr","useKeyComposition","createComponent","isDeepEqual","stop","prevent","stopAndPrevent","normalizeToInterval","shouldIgnoreKey","isKeyCode","hMergeSlot","validateNewValueMode","v","includes","reEscapeList","fieldPropsList","Object","keys","name","inheritAttrs","props","modelValue","required","multiple","Boolean","displayValue","String","Number","displayValueHtml","dropdownIcon","options","type","Array","default","optionValue","Function","optionLabel","optionDisable","hideSelected","hideDropdownIcon","fillInput","maxValues","optionsDense","optionsDark","optionsSelectedClass","optionsHtml","optionsCover","menuShrink","menuAnchor","menuSelf","menuOffset","popupContentClass","popupContentStyle","useInput","useChips","newValueMode","validator","mapOptions","emitValue","inputDebounce","inputClass","inputStyle","tabindex","autocomplete","transitionShow","transitionHide","transitionDuration","behavior","virtualScrollItemSize","onNewValue","onFilter","emits","setup","slots","emit","proxy","$q","menu","dialog","optionIndex","inputValue","dialogFieldFocused","innerLoadingIndicator","inputTimer","innerValueCache","hasDialog","userInputValue","filterId","defaultInputValue","transitionShowComputed","searchBuffer","searchBufferExp","inputRef","targetRef","menuRef","dialogRef","menuContentRef","nameProp","onComposition","onInput","virtualScrollLength","isArray","length","virtualScrollItemSizeComputed","virtualScrollSliceRange","virtualScrollSliceSizeComputed","localResetVirtualScroll","padVirtualScroll","onVirtualScrollEvt","scrollTo","setVirtualScrollSize","getVirtualScrollTarget","getVirtualScrollEl","state","innerValue","mapNull","val","cache","values","map","getOption","filter","innerFieldProps","acc","forEach","key","isOptionsDark","isDark","value","hasValue","computedInputClass","cls","menuContentClass","virtualScrollHorizontal","noOptions","selectedString","opt","getOptionLabel","join","ariaCurrentValue","needsHtmlFn","html","valueAsHtml","some","focused","comboboxAttrs","attrs","role","label","readonly","targetUid","listboxAttrs","id","selectedScope","i","index","selected","removeAtIndex","removeAtIndexAndFocus","toggleOption","optionScope","from","to","slice","disable","isOptionDisabled","itemProps","clickable","active","activeClass","computedOptionsSelectedClass","manualFocus","dense","dark","onClick","isOptionSelected","platform","is","desktop","onMousemove","setOptionIndex","dropdownArrowIcon","iconSet","arrow","dropdown","squaredMenu","outlined","standout","borderless","rounded","color","getOptionValue","getPropValueFn","innerOptionsValue","inputControlEvents","evt","onChange","onKeydown","onTargetKeydown","onKeyup","onTargetAutocomplete","onKeypress","onTargetKeypress","onFocus","selectInputText","e","onCompositionstart","onCompositionupdate","onCompositionend","innerLoading","resetInputValue","immediate","updateMenu","rerenderMenu","getEmittingOptionValue","model","splice","focus","add","unique","updateInputValue","push","keepOpen","editable","optValue","hidePopup","findIndex","moveOptionSelection","offset","skipInputValue","setInputValue","valueCache","fn","find","propValue","defaultVal","target","select","onTargetKeyup","keyCode","clearTimeout","needle","toLocaleLowerCase","findFn","extractFn","option","indexOf","fillFn","afterFilter","clearValue","newValueModeValid","tabShouldSelect","shiftKey","closeMenu","showPopup","Math","max","min","view","optionsLength","Date","now","altKey","ctrlKey","metaKey","char","keyRepeat","searchRe","RegExp","split","l","test","done","mode","contentEl","getSelection","scope","concat","removable","textColor","onRemove","class","getAllOptions","getInput","fromDialog","isTarget","splitAttrs","attributes","data","style","maxlength","autofocus","disabled","qComposing","setTimeout","noFiltering","internal","keepClosed","afterUpdateFn","localFilterId","afterFn","getMenu","fit","cover","anchor","self","noParentEvent","noRefocus","noFocus","square","separateClosePopup","onScrollPassive","onBeforeShow","onControlPopupShow","onBeforeHide","onMenuBeforeHide","onShow","onMenuShow","onControlPopupHide","onDialogFieldFocus","window","pageXOffset","scrollX","document","body","scrollLeft","onDialogFieldBlur","getDialog","content","fieldClass","for","loading","itemAligned","filled","stackLabel","listeners","onBlur","rawControl","getControl","before","after","position","onDialogBeforeHide","onHide","onDialogHide","onDialogShow","__updateRefocusTarget","rootRef","querySelector","el","activeElement","onControlFocusin","show","newLength","oldLength","updateMenuPosition","updatePosition","hasPopupOpen","onControlFocusout","updatePreState","mobile","ios","assign","getOptionIndex","args","apply","floatingLabel","getControlChild","controlEvents","onFocusin","onFocusout","child","opts","getInnerAppend"],"sources":["D:/LearnVueJS/Vue3/Projects/fa-sop-online/node_modules/quasar/src/components/select/QSelect.js"],"sourcesContent":["import { h, ref, computed, watch, onBeforeUpdate, onUpdated, onBeforeUnmount, nextTick, getCurrentInstance } from 'vue'\n\nimport QField from '../field/QField.js'\nimport QIcon from '../icon/QIcon.js'\nimport QChip from '../chip/QChip.js'\n\nimport QItem from '../item/QItem.js'\nimport QItemSection from '../item/QItemSection.js'\nimport QItemLabel from '../item/QItemLabel.js'\n\nimport QMenu from '../menu/QMenu.js'\nimport QDialog from '../dialog/QDialog.js'\n\nimport useField, { useFieldState, useFieldProps, useFieldEmits, fieldValueIsFilled } from '../../composables/private/use-field.js'\nimport { useVirtualScroll, useVirtualScrollProps } from '../virtual-scroll/use-virtual-scroll.js'\nimport { useFormProps, useFormInputNameAttr } from '../../composables/private/use-form.js'\nimport useKeyComposition from '../../composables/private/use-key-composition.js'\n\nimport { createComponent } from '../../utils/private/create.js'\nimport { isDeepEqual } from '../../utils/is.js'\nimport { stop, prevent, stopAndPrevent } from '../../utils/event.js'\nimport { normalizeToInterval } from '../../utils/format.js'\nimport { shouldIgnoreKey, isKeyCode } from '../../utils/private/key-composition.js'\nimport { hMergeSlot } from '../../utils/private/render.js'\n\nconst validateNewValueMode = v => [ 'add', 'add-unique', 'toggle' ].includes(v)\nconst reEscapeList = '.*+?^${}()|[]\\\\'\nconst fieldPropsList = Object.keys(useFieldProps)\n\nexport default createComponent({\n  name: 'QSelect',\n\n  inheritAttrs: false,\n\n  props: {\n    ...useVirtualScrollProps,\n    ...useFormProps,\n    ...useFieldProps,\n\n    modelValue: {\n      required: true\n    },\n\n    multiple: Boolean,\n\n    displayValue: [ String, Number ],\n    displayValueHtml: Boolean,\n    dropdownIcon: String,\n\n    options: {\n      type: Array,\n      default: () => []\n    },\n\n    optionValue: [ Function, String ],\n    optionLabel: [ Function, String ],\n    optionDisable: [ Function, String ],\n\n    hideSelected: Boolean,\n    hideDropdownIcon: Boolean,\n    fillInput: Boolean,\n\n    maxValues: [ Number, String ],\n\n    optionsDense: Boolean,\n    optionsDark: {\n      type: Boolean,\n      default: null\n    },\n    optionsSelectedClass: String,\n    optionsHtml: Boolean,\n\n    optionsCover: Boolean,\n\n    menuShrink: Boolean,\n    menuAnchor: String,\n    menuSelf: String,\n    menuOffset: Array,\n\n    popupContentClass: String,\n    popupContentStyle: [ String, Array, Object ],\n\n    useInput: Boolean,\n    useChips: Boolean,\n\n    newValueMode: {\n      type: String,\n      validator: validateNewValueMode\n    },\n\n    mapOptions: Boolean,\n    emitValue: Boolean,\n\n    inputDebounce: {\n      type: [ Number, String ],\n      default: 500\n    },\n\n    inputClass: [ Array, String, Object ],\n    inputStyle: [ Array, String, Object ],\n\n    tabindex: {\n      type: [ String, Number ],\n      default: 0\n    },\n\n    autocomplete: String,\n\n    transitionShow: String,\n    transitionHide: String,\n    transitionDuration: [ String, Number ],\n\n    behavior: {\n      type: String,\n      validator: v => [ 'default', 'menu', 'dialog' ].includes(v),\n      default: 'default'\n    },\n\n    virtualScrollItemSize: {\n      type: [ Number, String ],\n      default: void 0\n    },\n\n    onNewValue: Function,\n    onFilter: Function\n  },\n\n  emits: [\n    ...useFieldEmits,\n    'add', 'remove', 'inputValue', 'newValue',\n    'keyup', 'keypress', 'keydown',\n    'filterAbort'\n  ],\n\n  setup (props, { slots, emit }) {\n    const { proxy } = getCurrentInstance()\n    const { $q } = proxy\n\n    const menu = ref(false)\n    const dialog = ref(false)\n    const optionIndex = ref(-1)\n    const inputValue = ref('')\n    const dialogFieldFocused = ref(false)\n    const innerLoadingIndicator = ref(false)\n\n    let inputTimer = null, innerValueCache,\n      hasDialog, userInputValue, filterId = null, defaultInputValue,\n      transitionShowComputed, searchBuffer, searchBufferExp\n\n    const inputRef = ref(null)\n    const targetRef = ref(null)\n    const menuRef = ref(null)\n    const dialogRef = ref(null)\n    const menuContentRef = ref(null)\n\n    const nameProp = useFormInputNameAttr(props)\n\n    const onComposition = useKeyComposition(onInput)\n\n    const virtualScrollLength = computed(() => (\n      Array.isArray(props.options)\n        ? props.options.length\n        : 0\n    ))\n\n    const virtualScrollItemSizeComputed = computed(() => (\n      props.virtualScrollItemSize === void 0\n        ? (props.optionsDense === true ? 24 : 48)\n        : props.virtualScrollItemSize\n    ))\n\n    const {\n      virtualScrollSliceRange,\n      virtualScrollSliceSizeComputed,\n      localResetVirtualScroll,\n      padVirtualScroll,\n      onVirtualScrollEvt,\n      scrollTo,\n      setVirtualScrollSize\n    } = useVirtualScroll({\n      virtualScrollLength, getVirtualScrollTarget, getVirtualScrollEl,\n      virtualScrollItemSizeComputed\n    })\n\n    const state = useFieldState()\n\n    const innerValue = computed(() => {\n      const\n        mapNull = props.mapOptions === true && props.multiple !== true,\n        val = props.modelValue !== void 0 && (props.modelValue !== null || mapNull === true)\n          ? (props.multiple === true && Array.isArray(props.modelValue) ? props.modelValue : [ props.modelValue ])\n          : []\n\n      if (props.mapOptions === true && Array.isArray(props.options) === true) {\n        const cache = props.mapOptions === true && innerValueCache !== void 0\n          ? innerValueCache\n          : []\n        const values = val.map(v => getOption(v, cache))\n\n        return props.modelValue === null && mapNull === true\n          ? values.filter(v => v !== null)\n          : values\n      }\n\n      return val\n    })\n\n    const innerFieldProps = computed(() => {\n      const acc = {}\n      fieldPropsList.forEach(key => {\n        const val = props[ key ]\n        if (val !== void 0) {\n          acc[ key ] = val\n        }\n      })\n      return acc\n    })\n\n    const isOptionsDark = computed(() => (\n      props.optionsDark === null\n        ? state.isDark.value\n        : props.optionsDark\n    ))\n\n    const hasValue = computed(() => fieldValueIsFilled(innerValue.value))\n\n    const computedInputClass = computed(() => {\n      let cls = 'q-field__input q-placeholder col'\n\n      if (props.hideSelected === true || innerValue.value.length === 0) {\n        return [ cls, props.inputClass ]\n      }\n\n      cls += ' q-field__input--padding'\n\n      return props.inputClass === void 0\n        ? cls\n        : [ cls, props.inputClass ]\n    })\n\n    const menuContentClass = computed(() =>\n      (props.virtualScrollHorizontal === true ? 'q-virtual-scroll--horizontal' : '')\n      + (props.popupContentClass ? ' ' + props.popupContentClass : '')\n    )\n\n    const noOptions = computed(() => virtualScrollLength.value === 0)\n\n    const selectedString = computed(() =>\n      innerValue.value\n        .map(opt => getOptionLabel.value(opt))\n        .join(', ')\n    )\n\n    const ariaCurrentValue = computed(() => (props.displayValue !== void 0\n      ? props.displayValue\n      : selectedString.value\n    ))\n\n    const needsHtmlFn = computed(() => (\n      props.optionsHtml === true\n        ? () => true\n        : opt => opt !== void 0 && opt !== null && opt.html === true\n    ))\n\n    const valueAsHtml = computed(() => (\n      props.displayValueHtml === true || (\n        props.displayValue === void 0 && (\n          props.optionsHtml === true\n          || innerValue.value.some(needsHtmlFn.value)\n        )\n      )\n    ))\n\n    const tabindex = computed(() => (state.focused.value === true ? props.tabindex : -1))\n\n    const comboboxAttrs = computed(() => {\n      const attrs = {\n        tabindex: props.tabindex,\n        role: 'combobox',\n        'aria-label': props.label,\n        'aria-readonly': props.readonly === true ? 'true' : 'false',\n        'aria-autocomplete': props.useInput === true ? 'list' : 'none',\n        'aria-expanded': menu.value === true ? 'true' : 'false',\n        'aria-controls': `${ state.targetUid.value }_lb`\n      }\n\n      if (optionIndex.value >= 0) {\n        attrs[ 'aria-activedescendant' ] = `${ state.targetUid.value }_${ optionIndex.value }`\n      }\n\n      return attrs\n    })\n\n    const listboxAttrs = computed(() => ({\n      id: `${ state.targetUid.value }_lb`,\n      role: 'listbox',\n      'aria-multiselectable': props.multiple === true ? 'true' : 'false'\n    }))\n\n    const selectedScope = computed(() => {\n      return innerValue.value.map((opt, i) => ({\n        index: i,\n        opt,\n        html: needsHtmlFn.value(opt),\n        selected: true,\n        removeAtIndex: removeAtIndexAndFocus,\n        toggleOption,\n        tabindex: tabindex.value\n      }))\n    })\n\n    const optionScope = computed(() => {\n      if (virtualScrollLength.value === 0) {\n        return []\n      }\n\n      const { from, to } = virtualScrollSliceRange.value\n\n      return props.options.slice(from, to).map((opt, i) => {\n        const disable = isOptionDisabled.value(opt) === true\n        const index = from + i\n\n        const itemProps = {\n          clickable: true,\n          active: false,\n          activeClass: computedOptionsSelectedClass.value,\n          manualFocus: true,\n          focused: false,\n          disable,\n          tabindex: -1,\n          dense: props.optionsDense,\n          dark: isOptionsDark.value,\n          role: 'option',\n          id: `${ state.targetUid.value }_${ index }`,\n          onClick: () => { toggleOption(opt) }\n        }\n\n        if (disable !== true) {\n          isOptionSelected(opt) === true && (itemProps.active = true)\n          optionIndex.value === index && (itemProps.focused = true)\n\n          itemProps[ 'aria-selected' ] = itemProps.active === true ? 'true' : 'false'\n\n          if ($q.platform.is.desktop === true) {\n            itemProps.onMousemove = () => { menu.value === true && setOptionIndex(index) }\n          }\n        }\n\n        return {\n          index,\n          opt,\n          html: needsHtmlFn.value(opt),\n          label: getOptionLabel.value(opt),\n          selected: itemProps.active,\n          focused: itemProps.focused,\n          toggleOption,\n          setOptionIndex,\n          itemProps\n        }\n      })\n    })\n\n    const dropdownArrowIcon = computed(() => (\n      props.dropdownIcon !== void 0\n        ? props.dropdownIcon\n        : $q.iconSet.arrow.dropdown\n    ))\n\n    const squaredMenu = computed(() =>\n      props.optionsCover === false\n      && props.outlined !== true\n      && props.standout !== true\n      && props.borderless !== true\n      && props.rounded !== true\n    )\n\n    const computedOptionsSelectedClass = computed(() => (\n      props.optionsSelectedClass !== void 0\n        ? props.optionsSelectedClass\n        : (props.color !== void 0 ? `text-${ props.color }` : '')\n    ))\n\n    // returns method to get value of an option;\n    // takes into account 'option-value' prop\n    const getOptionValue = computed(() => getPropValueFn(props.optionValue, 'value'))\n\n    // returns method to get label of an option;\n    // takes into account 'option-label' prop\n    const getOptionLabel = computed(() => getPropValueFn(props.optionLabel, 'label'))\n\n    // returns method to tell if an option is disabled;\n    // takes into account 'option-disable' prop\n    const isOptionDisabled = computed(() => getPropValueFn(props.optionDisable, 'disable'))\n\n    const innerOptionsValue = computed(() => innerValue.value.map(opt => getOptionValue.value(opt)))\n\n    const inputControlEvents = computed(() => {\n      const evt = {\n        onInput,\n        // Safari < 10.2 & UIWebView doesn't fire compositionend when\n        // switching focus before confirming composition choice\n        // this also fixes the issue where some browsers e.g. iOS Chrome\n        // fires \"change\" instead of \"input\" on autocomplete.\n        onChange: onComposition,\n        onKeydown: onTargetKeydown,\n        onKeyup: onTargetAutocomplete,\n        onKeypress: onTargetKeypress,\n        onFocus: selectInputText,\n        onClick (e) { hasDialog === true && stop(e) }\n      }\n\n      evt.onCompositionstart = evt.onCompositionupdate = evt.onCompositionend = onComposition\n\n      return evt\n    })\n\n    watch(innerValue, val => {\n      innerValueCache = val\n\n      if (\n        props.useInput === true\n        && props.fillInput === true\n        && props.multiple !== true\n        // Prevent re-entering in filter while filtering\n        // Also prevent clearing inputValue while filtering\n        && state.innerLoading.value !== true\n        && ((dialog.value !== true && menu.value !== true) || hasValue.value !== true)\n      ) {\n        userInputValue !== true && resetInputValue()\n        if (dialog.value === true || menu.value === true) {\n          filter('')\n        }\n      }\n    }, { immediate: true })\n\n    watch(() => props.fillInput, resetInputValue)\n\n    watch(menu, updateMenu)\n\n    watch(virtualScrollLength, rerenderMenu)\n\n    function getEmittingOptionValue (opt) {\n      return props.emitValue === true\n        ? getOptionValue.value(opt)\n        : opt\n    }\n\n    function removeAtIndex (index) {\n      if (index > -1 && index < innerValue.value.length) {\n        if (props.multiple === true) {\n          const model = props.modelValue.slice()\n          emit('remove', { index, value: model.splice(index, 1)[ 0 ] })\n          emit('update:modelValue', model)\n        }\n        else {\n          emit('update:modelValue', null)\n        }\n      }\n    }\n\n    function removeAtIndexAndFocus (index) {\n      removeAtIndex(index)\n      state.focus()\n    }\n\n    function add (opt, unique) {\n      const val = getEmittingOptionValue(opt)\n\n      if (props.multiple !== true) {\n        props.fillInput === true && updateInputValue(\n          getOptionLabel.value(opt),\n          true,\n          true\n        )\n\n        emit('update:modelValue', val)\n        return\n      }\n\n      if (innerValue.value.length === 0) {\n        emit('add', { index: 0, value: val })\n        emit('update:modelValue', props.multiple === true ? [ val ] : val)\n        return\n      }\n\n      if (unique === true && isOptionSelected(opt) === true) {\n        return\n      }\n\n      if (props.maxValues !== void 0 && props.modelValue.length >= props.maxValues) {\n        return\n      }\n\n      const model = props.modelValue.slice()\n\n      emit('add', { index: model.length, value: val })\n      model.push(val)\n      emit('update:modelValue', model)\n    }\n\n    function toggleOption (opt, keepOpen) {\n      if (state.editable.value !== true || opt === void 0 || isOptionDisabled.value(opt) === true) {\n        return\n      }\n\n      const optValue = getOptionValue.value(opt)\n\n      if (props.multiple !== true) {\n        if (keepOpen !== true) {\n          updateInputValue(\n            props.fillInput === true ? getOptionLabel.value(opt) : '',\n            true,\n            true\n          )\n\n          hidePopup()\n        }\n\n        targetRef.value !== null && targetRef.value.focus()\n\n        if (\n          innerValue.value.length === 0\n          || isDeepEqual(getOptionValue.value(innerValue.value[ 0 ]), optValue) !== true\n        ) {\n          emit('update:modelValue', props.emitValue === true ? optValue : opt)\n        }\n        return\n      }\n\n      (hasDialog !== true || dialogFieldFocused.value === true) && state.focus()\n\n      selectInputText()\n\n      if (innerValue.value.length === 0) {\n        const val = props.emitValue === true ? optValue : opt\n        emit('add', { index: 0, value: val })\n        emit('update:modelValue', props.multiple === true ? [ val ] : val)\n        return\n      }\n\n      const\n        model = props.modelValue.slice(),\n        index = innerOptionsValue.value.findIndex(v => isDeepEqual(v, optValue))\n\n      if (index > -1) {\n        emit('remove', { index, value: model.splice(index, 1)[ 0 ] })\n      }\n      else {\n        if (props.maxValues !== void 0 && model.length >= props.maxValues) {\n          return\n        }\n\n        const val = props.emitValue === true ? optValue : opt\n\n        emit('add', { index: model.length, value: val })\n        model.push(val)\n      }\n\n      emit('update:modelValue', model)\n    }\n\n    function setOptionIndex (index) {\n      if ($q.platform.is.desktop !== true) { return }\n\n      const val = index > -1 && index < virtualScrollLength.value\n        ? index\n        : -1\n\n      if (optionIndex.value !== val) {\n        optionIndex.value = val\n      }\n    }\n\n    function moveOptionSelection (offset = 1, skipInputValue) {\n      if (menu.value === true) {\n        let index = optionIndex.value\n        do {\n          index = normalizeToInterval(\n            index + offset,\n            -1,\n            virtualScrollLength.value - 1\n          )\n        }\n        while (index !== -1 && index !== optionIndex.value && isOptionDisabled.value(props.options[ index ]) === true)\n\n        if (optionIndex.value !== index) {\n          setOptionIndex(index)\n          scrollTo(index)\n\n          if (skipInputValue !== true && props.useInput === true && props.fillInput === true) {\n            setInputValue(index >= 0\n              ? getOptionLabel.value(props.options[ index ])\n              : defaultInputValue\n            )\n          }\n        }\n      }\n    }\n\n    function getOption (value, valueCache) {\n      const fn = opt => isDeepEqual(getOptionValue.value(opt), value)\n      return props.options.find(fn) || valueCache.find(fn) || value\n    }\n\n    function getPropValueFn (propValue, defaultVal) {\n      const val = propValue !== void 0\n        ? propValue\n        : defaultVal\n\n      return typeof val === 'function'\n        ? val\n        : opt => (opt !== null && typeof opt === 'object' && val in opt ? opt[ val ] : opt)\n    }\n\n    function isOptionSelected (opt) {\n      const val = getOptionValue.value(opt)\n      return innerOptionsValue.value.find(v => isDeepEqual(v, val)) !== void 0\n    }\n\n    function selectInputText (e) {\n      if (\n        props.useInput === true\n        && targetRef.value !== null\n        && (e === void 0 || (targetRef.value === e.target && e.target.value === selectedString.value))\n      ) {\n        targetRef.value.select()\n      }\n    }\n\n    function onTargetKeyup (e) {\n      // if ESC and we have an opened menu\n      // then stop propagation (might be caught by a QDialog\n      // and so it will also close the QDialog, which is wrong)\n      if (isKeyCode(e, 27) === true && menu.value === true) {\n        stop(e)\n        // on ESC we need to close the dialog also\n        hidePopup()\n        resetInputValue()\n      }\n\n      emit('keyup', e)\n    }\n\n    function onTargetAutocomplete (e) {\n      const { value } = e.target\n\n      if (e.keyCode !== void 0) {\n        onTargetKeyup(e)\n        return\n      }\n\n      e.target.value = ''\n\n      if (inputTimer !== null) {\n        clearTimeout(inputTimer)\n        inputTimer = null\n      }\n\n      resetInputValue()\n\n      if (typeof value === 'string' && value.length !== 0) {\n        const needle = value.toLocaleLowerCase()\n        const findFn = extractFn => {\n          const option = props.options.find(opt => extractFn.value(opt).toLocaleLowerCase() === needle)\n\n          if (option === void 0) {\n            return false\n          }\n\n          if (innerValue.value.indexOf(option) === -1) {\n            toggleOption(option)\n          }\n          else {\n            hidePopup()\n          }\n\n          return true\n        }\n        const fillFn = afterFilter => {\n          if (findFn(getOptionValue) === true) {\n            return\n          }\n          if (findFn(getOptionLabel) === true || afterFilter === true) {\n            return\n          }\n\n          filter(value, true, () => fillFn(true))\n        }\n\n        fillFn()\n      }\n      else {\n        state.clearValue(e)\n      }\n    }\n\n    function onTargetKeypress (e) {\n      emit('keypress', e)\n    }\n\n    function onTargetKeydown (e) {\n      emit('keydown', e)\n\n      if (shouldIgnoreKey(e) === true) {\n        return\n      }\n\n      const newValueModeValid = inputValue.value.length !== 0\n        && (props.newValueMode !== void 0 || props.onNewValue !== void 0)\n\n      const tabShouldSelect = e.shiftKey !== true\n        && props.multiple !== true\n        && (optionIndex.value > -1 || newValueModeValid === true)\n\n      // escape\n      if (e.keyCode === 27) {\n        prevent(e) // prevent clearing the inputValue\n        return\n      }\n\n      // tab\n      if (e.keyCode === 9 && tabShouldSelect === false) {\n        closeMenu()\n        return\n      }\n\n      if (e.target === void 0 || e.target.id !== state.targetUid.value) { return }\n\n      // down\n      if (\n        e.keyCode === 40\n        && state.innerLoading.value !== true\n        && menu.value === false\n      ) {\n        stopAndPrevent(e)\n        showPopup()\n        return\n      }\n\n      // backspace\n      if (\n        e.keyCode === 8\n        && props.hideSelected !== true\n        && inputValue.value.length === 0\n      ) {\n        if (props.multiple === true && Array.isArray(props.modelValue) === true) {\n          removeAtIndex(props.modelValue.length - 1)\n        }\n        else if (props.multiple !== true && props.modelValue !== null) {\n          emit('update:modelValue', null)\n        }\n        return\n      }\n\n      // home, end - 36, 35\n      if (\n        (e.keyCode === 35 || e.keyCode === 36)\n        && (typeof inputValue.value !== 'string' || inputValue.value.length === 0)\n      ) {\n        stopAndPrevent(e)\n        optionIndex.value = -1\n        moveOptionSelection(e.keyCode === 36 ? 1 : -1, props.multiple)\n      }\n\n      // pg up, pg down - 33, 34\n      if (\n        (e.keyCode === 33 || e.keyCode === 34)\n        && virtualScrollSliceSizeComputed.value !== void 0\n      ) {\n        stopAndPrevent(e)\n        optionIndex.value = Math.max(\n          -1,\n          Math.min(\n            virtualScrollLength.value,\n            optionIndex.value + (e.keyCode === 33 ? -1 : 1) * virtualScrollSliceSizeComputed.value.view\n          )\n        )\n        moveOptionSelection(e.keyCode === 33 ? 1 : -1, props.multiple)\n      }\n\n      // up, down\n      if (e.keyCode === 38 || e.keyCode === 40) {\n        stopAndPrevent(e)\n        moveOptionSelection(e.keyCode === 38 ? -1 : 1, props.multiple)\n      }\n\n      const optionsLength = virtualScrollLength.value\n\n      // clear search buffer if expired\n      if (searchBuffer === void 0 || searchBufferExp < Date.now()) {\n        searchBuffer = ''\n      }\n\n      // keyboard search when not having use-input\n      if (\n        optionsLength > 0\n        && props.useInput !== true\n        && e.key !== void 0\n        && e.key.length === 1 // printable char\n        && e.altKey === false // not kbd shortcut\n        && e.ctrlKey === false // not kbd shortcut\n        && e.metaKey === false // not kbd shortcut, especially on macOS with Command key\n        && (e.keyCode !== 32 || searchBuffer.length !== 0) // space in middle of search\n      ) {\n        menu.value !== true && showPopup(e)\n\n        const\n          char = e.key.toLocaleLowerCase(),\n          keyRepeat = searchBuffer.length === 1 && searchBuffer[ 0 ] === char\n\n        searchBufferExp = Date.now() + 1500\n        if (keyRepeat === false) {\n          stopAndPrevent(e)\n          searchBuffer += char\n        }\n\n        const searchRe = new RegExp('^' + searchBuffer.split('').map(l => (reEscapeList.indexOf(l) > -1 ? '\\\\' + l : l)).join('.*'), 'i')\n\n        let index = optionIndex.value\n\n        if (keyRepeat === true || index < 0 || searchRe.test(getOptionLabel.value(props.options[ index ])) !== true) {\n          do {\n            index = normalizeToInterval(index + 1, -1, optionsLength - 1)\n          }\n          while (index !== optionIndex.value && (\n            isOptionDisabled.value(props.options[ index ]) === true\n            || searchRe.test(getOptionLabel.value(props.options[ index ])) !== true\n          ))\n        }\n\n        if (optionIndex.value !== index) {\n          nextTick(() => {\n            setOptionIndex(index)\n            scrollTo(index)\n\n            if (index >= 0 && props.useInput === true && props.fillInput === true) {\n              setInputValue(getOptionLabel.value(props.options[ index ]))\n            }\n          })\n        }\n\n        return\n      }\n\n      // enter, space (when not using use-input and not in search), or tab (when not using multiple and option selected)\n      // same target is checked above\n      if (\n        e.keyCode !== 13\n        && (e.keyCode !== 32 || props.useInput === true || searchBuffer !== '')\n        && (e.keyCode !== 9 || tabShouldSelect === false)\n      ) { return }\n\n      e.keyCode !== 9 && stopAndPrevent(e)\n\n      if (optionIndex.value > -1 && optionIndex.value < optionsLength) {\n        toggleOption(props.options[ optionIndex.value ])\n        return\n      }\n\n      if (newValueModeValid === true) {\n        const done = (val, mode) => {\n          if (mode) {\n            if (validateNewValueMode(mode) !== true) {\n              return\n            }\n          }\n          else {\n            mode = props.newValueMode\n          }\n\n          if (val === void 0 || val === null) {\n            return\n          }\n\n          updateInputValue('', props.multiple !== true, true)\n\n          const fn = mode === 'toggle' ? toggleOption : add\n          fn(val, mode === 'add-unique')\n\n          if (props.multiple !== true) {\n            targetRef.value !== null && targetRef.value.focus()\n            hidePopup()\n          }\n        }\n\n        if (props.onNewValue !== void 0) {\n          emit('newValue', inputValue.value, done)\n        }\n        else {\n          done(inputValue.value)\n        }\n\n        if (props.multiple !== true) {\n          return\n        }\n      }\n\n      if (menu.value === true) {\n        closeMenu()\n      }\n      else if (state.innerLoading.value !== true) {\n        showPopup()\n      }\n    }\n\n    function getVirtualScrollEl () {\n      return hasDialog === true\n        ? menuContentRef.value\n        : (\n            menuRef.value !== null && menuRef.value.contentEl !== null\n              ? menuRef.value.contentEl\n              : void 0\n          )\n    }\n\n    function getVirtualScrollTarget () {\n      return getVirtualScrollEl()\n    }\n\n    function getSelection () {\n      if (props.hideSelected === true) {\n        return []\n      }\n\n      if (slots[ 'selected-item' ] !== void 0) {\n        return selectedScope.value.map(scope => slots[ 'selected-item' ](scope)).slice()\n      }\n\n      if (slots.selected !== void 0) {\n        return [].concat(slots.selected())\n      }\n\n      if (props.useChips === true) {\n        return selectedScope.value.map((scope, i) => h(QChip, {\n          key: 'option-' + i,\n          removable: state.editable.value === true && isOptionDisabled.value(scope.opt) !== true,\n          dense: true,\n          textColor: props.color,\n          tabindex: tabindex.value,\n          onRemove () { scope.removeAtIndex(i) }\n        }, () => h('span', {\n          class: 'ellipsis',\n          [ scope.html === true ? 'innerHTML' : 'textContent' ]: getOptionLabel.value(scope.opt)\n        })))\n      }\n\n      return [\n        h('span', {\n          [ valueAsHtml.value === true ? 'innerHTML' : 'textContent' ]: ariaCurrentValue.value\n        })\n      ]\n    }\n\n    function getAllOptions () {\n      if (noOptions.value === true) {\n        return slots[ 'no-option' ] !== void 0\n          ? slots[ 'no-option' ]({ inputValue: inputValue.value })\n          : void 0\n      }\n\n      const fn = slots.option !== void 0\n        ? slots.option\n        : scope => {\n          return h(QItem, {\n            key: scope.index,\n            ...scope.itemProps\n          }, () => {\n            return h(\n              QItemSection,\n              () => h(\n                QItemLabel,\n                () => h('span', {\n                  [ scope.html === true ? 'innerHTML' : 'textContent' ]: scope.label\n                })\n              )\n            )\n          })\n        }\n\n      let options = padVirtualScroll('div', optionScope.value.map(fn))\n\n      if (slots[ 'before-options' ] !== void 0) {\n        options = slots[ 'before-options' ]().concat(options)\n      }\n\n      return hMergeSlot(slots[ 'after-options' ], options)\n    }\n\n    function getInput (fromDialog, isTarget) {\n      const attrs = isTarget === true ? { ...comboboxAttrs.value, ...state.splitAttrs.attributes.value } : void 0\n\n      const data = {\n        ref: isTarget === true ? targetRef : void 0,\n        key: 'i_t',\n        class: computedInputClass.value,\n        style: props.inputStyle,\n        value: inputValue.value !== void 0 ? inputValue.value : '',\n        // required for Android in order to show ENTER key when in form\n        type: 'search',\n        ...attrs,\n        id: isTarget === true ? state.targetUid.value : void 0,\n        maxlength: props.maxlength,\n        autocomplete: props.autocomplete,\n        'data-autofocus': fromDialog === true || props.autofocus === true || void 0,\n        disabled: props.disable === true,\n        readonly: props.readonly === true,\n        ...inputControlEvents.value\n      }\n\n      if (fromDialog !== true && hasDialog === true) {\n        if (Array.isArray(data.class) === true) {\n          data.class = [ ...data.class, 'no-pointer-events' ]\n        }\n        else {\n          data.class += ' no-pointer-events'\n        }\n      }\n\n      return h('input', data)\n    }\n\n    function onInput (e) {\n      if (inputTimer !== null) {\n        clearTimeout(inputTimer)\n        inputTimer = null\n      }\n\n      if (e && e.target && e.target.qComposing === true) {\n        return\n      }\n\n      setInputValue(e.target.value || '')\n      // mark it here as user input so that if updateInputValue is called\n      // before filter is called the indicator is reset\n      userInputValue = true\n      defaultInputValue = inputValue.value\n\n      if (\n        state.focused.value !== true\n        && (hasDialog !== true || dialogFieldFocused.value === true)\n      ) {\n        state.focus()\n      }\n\n      if (props.onFilter !== void 0) {\n        inputTimer = setTimeout(() => {\n          inputTimer = null\n          filter(inputValue.value)\n        }, props.inputDebounce)\n      }\n    }\n\n    function setInputValue (val) {\n      if (inputValue.value !== val) {\n        inputValue.value = val\n        emit('inputValue', val)\n      }\n    }\n\n    function updateInputValue (val, noFiltering, internal) {\n      userInputValue = internal !== true\n\n      if (props.useInput === true) {\n        setInputValue(val)\n\n        if (noFiltering === true || internal !== true) {\n          defaultInputValue = val\n        }\n\n        noFiltering !== true && filter(val)\n      }\n    }\n\n    function filter (val, keepClosed, afterUpdateFn) {\n      if (props.onFilter === void 0 || (keepClosed !== true && state.focused.value !== true)) {\n        return\n      }\n\n      if (state.innerLoading.value === true) {\n        emit('filterAbort')\n      }\n      else {\n        state.innerLoading.value = true\n        innerLoadingIndicator.value = true\n      }\n\n      if (\n        val !== ''\n        && props.multiple !== true\n        && innerValue.value.length !== 0\n        && userInputValue !== true\n        && val === getOptionLabel.value(innerValue.value[ 0 ])\n      ) {\n        val = ''\n      }\n\n      const localFilterId = setTimeout(() => {\n        menu.value === true && (menu.value = false)\n      }, 10)\n\n      filterId !== null && clearTimeout(filterId)\n      filterId = localFilterId\n\n      emit(\n        'filter',\n        val,\n        (fn, afterFn) => {\n          if ((keepClosed === true || state.focused.value === true) && filterId === localFilterId) {\n            clearTimeout(filterId)\n\n            typeof fn === 'function' && fn()\n\n            // hide indicator to allow arrow to animate\n            innerLoadingIndicator.value = false\n\n            nextTick(() => {\n              state.innerLoading.value = false\n\n              if (state.editable.value === true) {\n                if (keepClosed === true) {\n                  menu.value === true && hidePopup()\n                }\n                else if (menu.value === true) {\n                  updateMenu(true)\n                }\n                else {\n                  menu.value = true\n                }\n              }\n\n              typeof afterFn === 'function' && nextTick(() => { afterFn(proxy) })\n              typeof afterUpdateFn === 'function' && nextTick(() => { afterUpdateFn(proxy) })\n            })\n          }\n        },\n        () => {\n          if (state.focused.value === true && filterId === localFilterId) {\n            clearTimeout(filterId)\n            state.innerLoading.value = false\n            innerLoadingIndicator.value = false\n          }\n          menu.value === true && (menu.value = false)\n        }\n      )\n    }\n\n    function getMenu () {\n      return h(QMenu, {\n        ref: menuRef,\n        class: menuContentClass.value,\n        style: props.popupContentStyle,\n        modelValue: menu.value,\n        fit: props.menuShrink !== true,\n        cover: props.optionsCover === true && noOptions.value !== true && props.useInput !== true,\n        anchor: props.menuAnchor,\n        self: props.menuSelf,\n        offset: props.menuOffset,\n        dark: isOptionsDark.value,\n        noParentEvent: true,\n        noRefocus: true,\n        noFocus: true,\n        square: squaredMenu.value,\n        transitionShow: props.transitionShow,\n        transitionHide: props.transitionHide,\n        transitionDuration: props.transitionDuration,\n        separateClosePopup: true,\n        ...listboxAttrs.value,\n        onScrollPassive: onVirtualScrollEvt,\n        onBeforeShow: onControlPopupShow,\n        onBeforeHide: onMenuBeforeHide,\n        onShow: onMenuShow\n      }, getAllOptions)\n    }\n\n    function onMenuBeforeHide (e) {\n      onControlPopupHide(e)\n      closeMenu()\n    }\n\n    function onMenuShow () {\n      setVirtualScrollSize()\n    }\n\n    function onDialogFieldFocus (e) {\n      stop(e)\n      targetRef.value !== null && targetRef.value.focus()\n      dialogFieldFocused.value = true\n      window.scrollTo(window.pageXOffset || window.scrollX || document.body.scrollLeft || 0, 0)\n    }\n\n    function onDialogFieldBlur (e) {\n      stop(e)\n      nextTick(() => {\n        dialogFieldFocused.value = false\n      })\n    }\n\n    function getDialog () {\n      const content = [\n        h(QField, {\n          class: `col-auto ${ state.fieldClass.value }`,\n          ...innerFieldProps.value,\n          for: state.targetUid.value,\n          dark: isOptionsDark.value,\n          square: true,\n          loading: innerLoadingIndicator.value,\n          itemAligned: false,\n          filled: true,\n          stackLabel: inputValue.value.length !== 0,\n          ...state.splitAttrs.listeners.value,\n          onFocus: onDialogFieldFocus,\n          onBlur: onDialogFieldBlur\n        }, {\n          ...slots,\n          rawControl: () => state.getControl(true),\n          before: void 0,\n          after: void 0\n        })\n      ]\n\n      menu.value === true && content.push(\n        h('div', {\n          ref: menuContentRef,\n          class: menuContentClass.value + ' scroll',\n          style: props.popupContentStyle,\n          ...listboxAttrs.value,\n          onClick: prevent,\n          onScrollPassive: onVirtualScrollEvt\n        }, getAllOptions())\n      )\n\n      return h(QDialog, {\n        ref: dialogRef,\n        modelValue: dialog.value,\n        position: props.useInput === true ? 'top' : void 0,\n        transitionShow: transitionShowComputed,\n        transitionHide: props.transitionHide,\n        transitionDuration: props.transitionDuration,\n        onBeforeShow: onControlPopupShow,\n        onBeforeHide: onDialogBeforeHide,\n        onHide: onDialogHide,\n        onShow: onDialogShow\n      }, () => h('div', {\n        class: 'q-select__dialog'\n          + (isOptionsDark.value === true ? ' q-select__dialog--dark q-dark' : '')\n          + (dialogFieldFocused.value === true ? ' q-select__dialog--focused' : '')\n      }, content))\n    }\n\n    function onDialogBeforeHide (e) {\n      onControlPopupHide(e)\n\n      if (dialogRef.value !== null) {\n        dialogRef.value.__updateRefocusTarget(\n          state.rootRef.value.querySelector('.q-field__native > [tabindex]:last-child')\n        )\n      }\n\n      state.focused.value = false\n    }\n\n    function onDialogHide (e) {\n      hidePopup()\n      state.focused.value === false && emit('blur', e)\n      resetInputValue()\n    }\n\n    function onDialogShow () {\n      const el = document.activeElement\n      if (\n        (el === null || el.id !== state.targetUid.value)\n        && targetRef.value !== null\n        && targetRef.value !== el\n      ) {\n        targetRef.value.focus()\n      }\n\n      setVirtualScrollSize()\n    }\n\n    function closeMenu () {\n      if (dialog.value === true) {\n        return\n      }\n\n      optionIndex.value = -1\n\n      if (menu.value === true) {\n        menu.value = false\n      }\n\n      if (state.focused.value === false) {\n        if (filterId !== null) {\n          clearTimeout(filterId)\n          filterId = null\n        }\n\n        if (state.innerLoading.value === true) {\n          emit('filterAbort')\n          state.innerLoading.value = false\n          innerLoadingIndicator.value = false\n        }\n      }\n    }\n\n    function showPopup (e) {\n      if (state.editable.value !== true) {\n        return\n      }\n\n      if (hasDialog === true) {\n        state.onControlFocusin(e)\n        dialog.value = true\n        nextTick(() => {\n          state.focus()\n        })\n      }\n      else {\n        state.focus()\n      }\n\n      if (props.onFilter !== void 0) {\n        filter(inputValue.value)\n      }\n      else if (noOptions.value !== true || slots[ 'no-option' ] !== void 0) {\n        menu.value = true\n      }\n    }\n\n    function hidePopup () {\n      dialog.value = false\n      closeMenu()\n    }\n\n    function resetInputValue () {\n      props.useInput === true && updateInputValue(\n        props.multiple !== true && props.fillInput === true && innerValue.value.length !== 0\n          ? getOptionLabel.value(innerValue.value[ 0 ]) || ''\n          : '',\n        true,\n        true\n      )\n    }\n\n    function updateMenu (show) {\n      let optionIndex = -1\n\n      if (show === true) {\n        if (innerValue.value.length !== 0) {\n          const val = getOptionValue.value(innerValue.value[ 0 ])\n          optionIndex = props.options.findIndex(v => isDeepEqual(getOptionValue.value(v), val))\n        }\n\n        localResetVirtualScroll(optionIndex)\n      }\n\n      setOptionIndex(optionIndex)\n    }\n\n    function rerenderMenu (newLength, oldLength) {\n      if (menu.value === true && state.innerLoading.value === false) {\n        localResetVirtualScroll(-1, true)\n\n        nextTick(() => {\n          if (menu.value === true && state.innerLoading.value === false) {\n            if (newLength > oldLength) {\n              localResetVirtualScroll()\n            }\n            else {\n              updateMenu(true)\n            }\n          }\n        })\n      }\n    }\n\n    function updateMenuPosition () {\n      if (dialog.value === false && menuRef.value !== null) {\n        menuRef.value.updatePosition()\n      }\n    }\n\n    function onControlPopupShow (e) {\n      e !== void 0 && stop(e)\n      emit('popupShow', e)\n      state.hasPopupOpen = true\n      state.onControlFocusin(e)\n    }\n\n    function onControlPopupHide (e) {\n      e !== void 0 && stop(e)\n      emit('popupHide', e)\n      state.hasPopupOpen = false\n      state.onControlFocusout(e)\n    }\n\n    function updatePreState () {\n      hasDialog = $q.platform.is.mobile !== true && props.behavior !== 'dialog'\n        ? false\n        : props.behavior !== 'menu' && (\n          props.useInput === true\n            ? slots[ 'no-option' ] !== void 0 || props.onFilter !== void 0 || noOptions.value === false\n            : true\n        )\n\n      transitionShowComputed = $q.platform.is.ios === true && hasDialog === true && props.useInput === true\n        ? 'fade'\n        : props.transitionShow\n    }\n\n    onBeforeUpdate(updatePreState)\n    onUpdated(updateMenuPosition)\n\n    updatePreState()\n\n    onBeforeUnmount(() => {\n      inputTimer !== null && clearTimeout(inputTimer)\n    })\n\n    // expose public methods\n    Object.assign(proxy, {\n      showPopup, hidePopup,\n      removeAtIndex, add, toggleOption,\n      getOptionIndex: () => optionIndex.value,\n      setOptionIndex, moveOptionSelection,\n      filter, updateMenuPosition, updateInputValue,\n      isOptionSelected,\n      getEmittingOptionValue,\n      isOptionDisabled: (...args) => isOptionDisabled.value.apply(null, args) === true,\n      getOptionValue: (...args) => getOptionValue.value.apply(null, args),\n      getOptionLabel: (...args) => getOptionLabel.value.apply(null, args)\n    })\n\n    Object.assign(state, {\n      innerValue,\n\n      fieldClass: computed(() =>\n        `q-select q-field--auto-height q-select--with${ props.useInput !== true ? 'out' : '' }-input`\n        + ` q-select--with${ props.useChips !== true ? 'out' : '' }-chips`\n        + ` q-select--${ props.multiple === true ? 'multiple' : 'single' }`\n      ),\n\n      inputRef,\n      targetRef,\n      hasValue,\n      showPopup,\n\n      floatingLabel: computed(() =>\n        (props.hideSelected !== true && hasValue.value === true)\n        || typeof inputValue.value === 'number'\n        || inputValue.value.length !== 0\n        || fieldValueIsFilled(props.displayValue)\n      ),\n\n      getControlChild: () => {\n        if (\n          state.editable.value !== false && (\n            dialog.value === true // dialog always has menu displayed, so need to render it\n            || noOptions.value !== true\n            || slots[ 'no-option' ] !== void 0\n          )\n        ) {\n          return hasDialog === true ? getDialog() : getMenu()\n        }\n        else if (state.hasPopupOpen === true) {\n          // explicitly set it otherwise TAB will not blur component\n          state.hasPopupOpen = false\n        }\n      },\n\n      controlEvents: {\n        onFocusin (e) { state.onControlFocusin(e) },\n        onFocusout (e) {\n          state.onControlFocusout(e, () => {\n            resetInputValue()\n            closeMenu()\n          })\n        },\n        onClick (e) {\n          // label from QField will propagate click on the input\n          prevent(e)\n\n          if (hasDialog !== true && menu.value === true) {\n            closeMenu()\n            targetRef.value !== null && targetRef.value.focus()\n            return\n          }\n\n          showPopup(e)\n        }\n      },\n\n      getControl: fromDialog => {\n        const child = getSelection()\n        const isTarget = fromDialog === true || dialog.value !== true || hasDialog !== true\n\n        if (props.useInput === true) {\n          child.push(getInput(fromDialog, isTarget))\n        }\n        // there can be only one (when dialog is opened the control in dialog should be target)\n        else if (state.editable.value === true) {\n          const attrs = isTarget === true ? comboboxAttrs.value : void 0\n\n          child.push(\n            h('input', {\n              ref: isTarget === true ? targetRef : void 0,\n              key: 'd_t',\n              class: 'q-select__focus-target',\n              id: isTarget === true ? state.targetUid.value : void 0,\n              value: ariaCurrentValue.value,\n              readonly: true,\n              'data-autofocus': fromDialog === true || props.autofocus === true || void 0,\n              ...attrs,\n              onKeydown: onTargetKeydown,\n              onKeyup: onTargetKeyup,\n              onKeypress: onTargetKeypress\n            })\n          )\n\n          if (isTarget === true && typeof props.autocomplete === 'string' && props.autocomplete.length !== 0) {\n            child.push(\n              h('input', {\n                class: 'q-select__autocomplete-input',\n                autocomplete: props.autocomplete,\n                tabindex: -1,\n                onKeyup: onTargetAutocomplete\n              })\n            )\n          }\n        }\n\n        if (nameProp.value !== void 0 && props.disable !== true && innerOptionsValue.value.length !== 0) {\n          const opts = innerOptionsValue.value.map(value => h('option', { value, selected: true }))\n\n          child.push(\n            h('select', {\n              class: 'hidden',\n              name: nameProp.value,\n              multiple: props.multiple\n            }, opts)\n          )\n        }\n\n        const attrs = props.useInput === true || isTarget !== true ? void 0 : state.splitAttrs.attributes.value\n\n        return h('div', {\n          class: 'q-field__native row items-center',\n          ...attrs,\n          ...state.splitAttrs.listeners.value\n        }, child)\n      },\n\n      getInnerAppend: () => (\n        props.loading !== true && innerLoadingIndicator.value !== true && props.hideDropdownIcon !== true\n          ? [\n              h(QIcon, {\n                class: 'q-select__dropdown-icon' + (menu.value === true ? ' rotate-180' : ''),\n                name: dropdownArrowIcon.value\n              })\n            ]\n          : null\n      )\n    })\n\n    return useField(state)\n  }\n})\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}