{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { Files, Tickets, Collection, Postcard, SetUp, DocumentChecked, DataBoard, DataAnalysis } from '@element-plus/icons-vue';\nimport MenuEdit from './MenuEdit.vue';\nexport default {\n  components: {\n    MenuEdit\n  },\n  methods: {\n    handleClickOutside(event) {\n      if (this.$refs.myDiv && !this.$refs.myDiv.contains(event.target)) {\n        this.showMenu = false;\n      }\n    },\n    handleNodeClick() {\n      // console.log(node)\n      // const element = document.querySelector(`[data-id=\"${data.id}\"]`);\n      // console.log(element)\n      // if (element) {\n      //     element.style.backgroundColor = 'yellow';\n      // }\n    },\n    MenuToTree(parrent) {\n      const temp = [];\n      let child = undefined;\n      parrent.forEach(element => {\n        child = undefined;\n        if (element.CHILDREN) child = this.MenuToTree(element.CHILDREN);\n        temp.push({\n          label: element.NAME,\n          children: child\n        });\n      });\n      return temp;\n    },\n    async getMenu() {\n      await this.axios.get('api/FAOnlineSOP/GetMainMenu').then(res => {\n        this.menu = this.MenuToTree(res.data);\n      }).catch(err => {\n        console.log(err.response.data);\n      });\n    },\n    AddNewMenu() {\n      this.EdittingMenu = undefined;\n      this.showMenu = false;\n      this.OpMode = 'Add New Menu';\n      this.ShowEditMenu = true;\n    },\n    async edit() {\n      await this.axios.post('api/FAOnlineSOP/GetEditMenu', this.currentNodeParent).then(res => {\n        this.EdittingMenu = res.data;\n        this.showMenu = false;\n        this.OpMode = 'Edit Menu';\n        this.ShowEditMenu = true;\n      }).catch(err => {\n        this.$message({\n          showClose: true,\n          type: \"error\",\n          message: err.response.data\n        });\n        this.showMenu = false;\n      });\n    },\n    FinishEdit() {\n      this.ShowEditMenu = false;\n      location.reload();\n    },\n    delete() {\n      this.showMenu = false;\n      this.deleteDialog = true;\n    },\n    async deleteMenu() {\n      await this.axios.post('api/FAOnlineSOP/DeleteMenu', this.currentNodeParent).then(res => {\n        this.$message({\n          showClose: true,\n          type: \"success\",\n          message: res.data\n        });\n        this.deleteDialog = false;\n        location.reload();\n      }).catch(err => {\n        this.$message({\n          showClose: true,\n          type: \"error\",\n          message: err.response.data\n        });\n        this.deleteDialog = false;\n        location.reload();\n      });\n    },\n    showContextMenu(event, onode, dd) {\n      this.currentNodeParent = [dd.label];\n      let node = undefined;\n      do {\n        if (!node) node = dd.parent;else node = node.parent;\n        if (node && node.label) this.currentNodeParent.push(node.label);\n      } while (node);\n      this.menuX = event.clientX;\n      this.menuY = event.clientY;\n      this.showMenu = true;\n    }\n  },\n  data() {\n    return {\n      EdittingMenu: undefined,\n      deleteDialog: false,\n      currentNodeParent: [],\n      OpMode: 'Add New Menu',\n      ShowEditMenu: false,\n      icons: [Files, Tickets, Collection, Postcard, SetUp, DocumentChecked, DataBoard, DataAnalysis],\n      defaultProps: {\n        children: 'children',\n        label: 'label'\n      },\n      menu: [],\n      menuOptions: [{\n        label: 'Add New',\n        action: this.AddNewMenu,\n        icon: 'fa-solid fa-square-plus'\n      }, {\n        label: 'Edit',\n        action: this.edit,\n        icon: 'fa-solid fa-screwdriver-wrench'\n      }, {\n        label: 'Delete',\n        action: this.delete,\n        icon: 'fa-solid fa-trash-can'\n      }],\n      showMenu: false,\n      menuX: 0,\n      menuY: 0\n    };\n  },\n  mounted() {\n    this.getMenu();\n    document.addEventListener('click', this.handleClickOutside);\n  },\n  beforeUnmount() {\n    document.removeEventListener('click', this.handleClickOutside);\n  }\n};","map":{"version":3,"names":["Files","Tickets","Collection","Postcard","SetUp","DocumentChecked","DataBoard","DataAnalysis","MenuEdit","components","methods","handleClickOutside","event","$refs","myDiv","contains","target","showMenu","handleNodeClick","MenuToTree","parrent","temp","child","undefined","forEach","element","CHILDREN","push","label","NAME","children","getMenu","axios","get","then","res","menu","data","catch","err","console","log","response","AddNewMenu","EdittingMenu","OpMode","ShowEditMenu","edit","post","currentNodeParent","$message","showClose","type","message","FinishEdit","location","reload","delete","deleteDialog","deleteMenu","showContextMenu","onode","dd","node","parent","menuX","clientX","menuY","clientY","icons","defaultProps","menuOptions","action","icon","mounted","document","addEventListener","beforeUnmount","removeEventListener"],"sources":["D:\\LearnVueJS\\Vue3\\Projects\\fa-sop-online\\src\\components\\AdminArea\\MenuManage.vue"],"sourcesContent":["<template>\r\n    <div style=\"height: 90vh;\">\r\n        <el-tree :data=\"menu\" :props=\"defaultProps\" @node-click=\"handleNodeClick\" @node-contextmenu=\"showContextMenu\"\r\n            :highlight-current=\"true\" default-expand-all :node-key=\"node => node.id\" />\r\n    </div>\r\n    <div ref=\"myDiv\" v-if=\"showMenu\" id=\"myContextMenu\" :style=\"{ left: `${menuX}px`, top: `${menuY}px` }\">\r\n        <ul>\r\n            <li v-for=\"(option, index) in menuOptions\" :key=\"index\" @click=\"option.action\"><i :class=\"option.icon\"></i> {{\r\n                option.label }}</li>\r\n        </ul>\r\n    </div>\r\n    <el-dialog v-model=\"ShowEditMenu\" :title=\"OpMode\">\r\n        <MenuEdit v-if=\"ShowEditMenu\" :EditMode=\"OpMode.includes('Edit Menu')\" :EdittingMenu=\"EdittingMenu\"\r\n            :ParentName=\"currentNodeParent[1]\" @CompleteSuccess=\"FinishEdit\"></MenuEdit>\r\n    </el-dialog>\r\n\r\n    <el-dialog v-model=\"deleteDialog\" title=\"Warning\" width=\"20%\" align-center>\r\n        <span>Delete this menu?</span>\r\n        <template #footer>\r\n            <span class=\"dialog-footer\">\r\n                <el-button @click=\"deleteDialog = false\">Cancel</el-button>\r\n                <el-button type=\"primary\" @click=\"deleteMenu\">\r\n                    Confirm\r\n                </el-button>\r\n            </span>\r\n        </template>\r\n    </el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { Files, Tickets, Collection, Postcard, SetUp, DocumentChecked, DataBoard, DataAnalysis } from '@element-plus/icons-vue'\r\nimport MenuEdit from './MenuEdit.vue'\r\nexport default {\r\n    components: {\r\n        MenuEdit\r\n    },\r\n    methods: {\r\n        handleClickOutside(event) {\r\n            if (this.$refs.myDiv && !this.$refs.myDiv.contains(event.target)) {\r\n                this.showMenu = false;\r\n            }\r\n        },\r\n    \r\n        handleNodeClick() {\r\n            // console.log(node)\r\n            // const element = document.querySelector(`[data-id=\"${data.id}\"]`);\r\n            // console.log(element)\r\n            // if (element) {\r\n            //     element.style.backgroundColor = 'yellow';\r\n            // }\r\n        },\r\n        MenuToTree(parrent) {\r\n            const temp = []; let child = undefined;\r\n            parrent.forEach(element => {\r\n                child = undefined;\r\n                if (element.CHILDREN) child = this.MenuToTree(element.CHILDREN);\r\n                temp.push({\r\n                    label: element.NAME,\r\n                    children: child\r\n                });\r\n            });\r\n            return temp;\r\n        },\r\n        async getMenu() {\r\n            await this.axios.get('api/FAOnlineSOP/GetMainMenu').then((res) => {\r\n                this.menu = this.MenuToTree(res.data);\r\n            }).catch((err) => {\r\n                console.log(err.response.data);\r\n            });\r\n        },\r\n        AddNewMenu() {\r\n            this.EdittingMenu = undefined;\r\n            this.showMenu = false;\r\n            this.OpMode = 'Add New Menu'\r\n            this.ShowEditMenu = true;\r\n        },\r\n        async edit() {\r\n            await this.axios.post('api/FAOnlineSOP/GetEditMenu', this.currentNodeParent).then((res) => {\r\n                this.EdittingMenu = res.data;\r\n                this.showMenu = false;\r\n                this.OpMode = 'Edit Menu'\r\n                this.ShowEditMenu = true;\r\n            }).catch((err) => {\r\n                this.$message({\r\n                    showClose: true,\r\n                    type: \"error\",\r\n                    message: err.response.data\r\n                });\r\n                this.showMenu = false;\r\n            });\r\n        }, FinishEdit() {\r\n            this.ShowEditMenu = false; location.reload();\r\n        },\r\n        delete() {\r\n            this.showMenu = false\r\n            this.deleteDialog = true\r\n        },\r\n        async deleteMenu() {\r\n            await this.axios.post('api/FAOnlineSOP/DeleteMenu', this.currentNodeParent).then((res) => {\r\n                this.$message({\r\n                    showClose: true,\r\n                    type: \"success\",\r\n                    message: res.data,\r\n                });\r\n                this.deleteDialog = false;\r\n                location.reload();\r\n            }).catch((err) => {\r\n                this.$message({\r\n                    showClose: true,\r\n                    type: \"error\",\r\n                    message: err.response.data\r\n                });\r\n                this.deleteDialog = false;\r\n                location.reload();\r\n            });\r\n        },\r\n        showContextMenu(event, onode, dd) {\r\n            this.currentNodeParent = [dd.label];\r\n            let node = undefined;\r\n            do {\r\n                if (!node) node = dd.parent; else node = node.parent;\r\n                if (node && node.label) this.currentNodeParent.push(node.label)\r\n            } while (node)\r\n            this.menuX = event.clientX;\r\n            this.menuY = event.clientY;\r\n            this.showMenu = true;\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            EdittingMenu: undefined,\r\n            deleteDialog: false,\r\n            currentNodeParent: [],\r\n            OpMode: 'Add New Menu',\r\n            ShowEditMenu: false,\r\n            icons: [Files, Tickets, Collection, Postcard, SetUp, DocumentChecked, DataBoard, DataAnalysis],\r\n            defaultProps: {\r\n                children: 'children',\r\n                label: 'label',\r\n            },\r\n            menu: [],\r\n            menuOptions: [\r\n                { label: 'Add New', action: this.AddNewMenu, icon: 'fa-solid fa-square-plus' },\r\n                { label: 'Edit', action: this.edit, icon: 'fa-solid fa-screwdriver-wrench' },\r\n                { label: 'Delete', action: this.delete, icon: 'fa-solid fa-trash-can' }\r\n            ],\r\n            showMenu: false,\r\n            menuX: 0,\r\n            menuY: 0\r\n        }\r\n    }, mounted() {\r\n        this.getMenu();\r\n        document.addEventListener('click', this.handleClickOutside);\r\n    },\r\n    beforeUnmount() {\r\n        document.removeEventListener('click', this.handleClickOutside);\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n#myContextMenu {\r\n    position: absolute;\r\n    background-color: white;\r\n    z-index: 999;\r\n    padding: 0;\r\n    box-shadow: 0px 5px 5px rgba(0, 0, 0, 0.25);\r\n\r\n    ul {\r\n        padding-left: 10px;\r\n        padding-right: 10px;\r\n        padding-top: 5px;\r\n        list-style-type: none;\r\n\r\n        li {\r\n            cursor: pointer;\r\n            text-align: left;\r\n        }\r\n\r\n        li:hover {\r\n            color: rgb(116, 39, 39);\r\n        }\r\n    }\r\n}\r\n\r\n.current_background {\r\n    background-color: blue;\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}